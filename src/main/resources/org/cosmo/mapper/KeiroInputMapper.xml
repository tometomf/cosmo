<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.cosmo.mapper.KeiroInputMapper">

    <resultMap id="ShainKeiroResultMap" type="org.cosmo.domain.ShainKeiroDTO">
        <result property="kigyoCd"         column="KIGYO_CD"/>
        <result property="shainUid"        column="SHAIN_UID"/>
        <result property="keiroSeq"        column="KEIRO_SEQ"/>

        <result property="tsukinShudanKbn" column="TSUKIN_SHUDAN_KBN"/>
        <result property="tsukinShudanNm"  column="TSUKIN_SHUDAN_NM"/>

        <result property="startPlace"      column="START_PLACE"/>
        <result property="endPlace"        column="END_PLACE"/>
        <result property="viaPlace1"       column="VIA_PLACE_1"/>
        <result property="viaPlace2"       column="VIA_PLACE_2"/>
        <result property="viaPlace3"       column="VIA_PLACE_3"/>
        <result property="viaPlace4"       column="VIA_PLACE_4"/>
        <result property="viaPlace5"       column="VIA_PLACE_5"/>

        <result property="shinseiKm"       column="SHINSEI_KM"/>
        <result property="shikyuKin"       column="SHIKYU_KIN"/>
    </resultMap>

    <select id="selectShainKeiroWithCode"
            parameterType="map"
            resultMap="ShainKeiroResultMap">

        SELECT
              sk.KIGYO_CD
            , sk.SHAIN_UID
            , sk.KEIRO_SEQ
            , sk.TSUKIN_SHUDAN_KBN
            , cd.CODE_NM AS TSUKIN_SHUDAN_NM
            , sk.START_PLACE
            , sk.END_PLACE
            , sk.VIA_PLACE_1
            , sk.VIA_PLACE_2
            , sk.VIA_PLACE_3
            , sk.VIA_PLACE_4
            , sk.VIA_PLACE_5
            , sk.SHINSEI_KM
            , sk.SHIKYU_KIN
        FROM
            SHAIN_KEIRO sk
            LEFT JOIN CODE cd
              ON cd.CODE_SYBTSU = '103'
             AND cd.CODE = sk.TSUKIN_SHUDAN_KBN
        WHERE
              sk.KIGYO_CD  = #{kigyoCd}
          AND sk.SHAIN_UID = #{shainUid}
          AND sk.KEIRO_SEQ = #{keiroSeq}

    </select>

</mapper>
