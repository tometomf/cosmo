<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.cosmo.mapper.ShinseiMapper">

	<!-- 하나 -->
	<select id="getShinseiJyohou" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiJyohouVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		SHINSEI_KBN AS shinseiKbn,
		SHINCHOKU_KBN AS shinchokuKbn,

		GEN_ADDRESS_1
		AS genAddress1,
		GEN_ADDRESS_2 AS genAddress2,
		GEN_ADDRESS_3 AS
		genAddress3,
		NEW_ADDRESS_1 AS newAddress1,
		NEW_ADDRESS_2 AS newAddress2,
		NEW_ADDRESS_3 AS newAddress3,

		GEN_SHOZOKU_CD AS genShozoku,
		NEW_SHOZOKU_CD AS newShozoku,


		GEN_KINMU_ZIP_CD AS genKinmuZipCd,
		GEN_KINMU_ADDRESS_1 AS genKinmuAddress1,
		GEN_KINMU_ADDRESS_2 AS
		genKinmuAddress2,
		GEN_KINMU_ADDRESS_3 AS genKinmuAddress3,

		NEW_KINMU_ZIP_CD AS newKinmuZipCd,
		NEW_KINMU_ADDRESS_1 AS
		newKinmuAddress1,
		NEW_KINMU_ADDRESS_2 AS newKinmuAddress2,
		NEW_KINMU_ADDRESS_3 AS newKinmuAddress3,

		GEN_KINMU_ADDRESS_1 AS
		genKinmuchi1,
		GEN_KINMU_ADDRESS_2 AS genKinmuchi2,
		GEN_KINMU_ADDRESS_3
		AS genKinmuchi3,
		NEW_KINMU_ADDRESS_1 AS newKinmuchi1,
		NEW_KINMU_ADDRESS_2 AS newKinmuchi2,
		NEW_KINMU_ADDRESS_3 AS
		newKinmuchi3,
		ETC_COMMENT_1 AS etcComment1,
		ETC_COMMENT_2 AS
		etcComment2,
		ETC_COMMENT_3 AS etcComment3,
		ETC_COMMENT_4 AS etcComment4,
		ETC_COMMENT_5 AS etcComment5,
		ETC_FILE_UID_1 AS etcFileUid1,
		ETC_FILE_UID_2 AS
		etcFileUid2,
		ETC_FILE_UID_3 AS etcFileUid3,
		ETC_FILE_UID_4 AS
		etcFileUid4,
		ETC_FILE_UID_5 AS etcFileUid5,
		KINMU_ADDRESS_IDO_KEIDO AS kinmuAddressIdoKeido,
		SHINSEI_RIYU AS riyu,
		IDO_YMD AS idoYmd,
		ITEN_YMD AS itenYmd,
		TENNYU_YMD
		AS tennyuYmd,
		RIYO_START_YMD AS
		riyoStartYmd,
		SHINSEI_YMD AS shinseiYmd,
		SASHIMODOSHI_YMD AS ssmdsYmd,
		MOSHIOKURI_COMMENT AS moComment,
		TORIKESHI_YMD AS torikeshiYmd
		FROM
		SHINSEI
		WHERE SHINSEI_NO =
		#{shinseiNo}
	</select>


	<select id="getShinseiKeiro" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiKeiroVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		TSUKIN_SHUDAN_KBN AS tsukinShudan,
		KATAMICHI_KIN
		AS katamichi,
		JITSU_KINMU_NISSU AS jitsu,
		TSUKI_SHIKYU_KIN AS tsuki,
		SHINSEI_KM AS shinseiKm,
		START_PLACE AS startPlace,
		YURYO_IC_S AS
		yuryoIcS,
		YURYO_IC_E AS yuryoIcE,
		END_PLACE AS
		endPlace
		FROM
		SHINSEI_START_KEIRO
		WHERE SHINSEI_NO = #{shinseiNo}
		AND KEIRO_SEQ = 1
	</select>

	<select id="getShinseiView" parameterType="map"
		resultType="org.cosmo.domain.ShinseiViewDTO">

		SELECT
		a.KIGYO_CD AS kigyoCd,
		a.SHINSEI_NO AS shinseiNo,
		a.SHINSEI_YMD AS shinseiYmd,
		a.SHINSEI_KBN AS shinseiKbn,
		a.SHINCHOKU_KBN AS shinchokuKbn,

		a.GEN_ADDRESS_1 AS genAddress1,
		a.GEN_ADDRESS_2 AS genAddress2,
		a.GEN_ADDRESS_3 AS genAddress3,
		a.NEW_ADDRESS_1 AS newAddress1,
		a.NEW_ADDRESS_2 AS newAddress2,
		a.NEW_ADDRESS_3 AS newAddress3,

		a.GEN_SHOZOKU_CD AS genShozoku,
		a.NEW_SHOZOKU_CD AS newShozoku,

		a.GEN_KINMU_ADDRESS_1 AS genKinmuchi1,
		a.GEN_KINMU_ADDRESS_2 AS genKinmuchi2,
		a.GEN_KINMU_ADDRESS_3 AS
		genKinmuchi3,
		a.NEW_KINMU_ADDRESS_1 AS newKinmuchi1,
		a.NEW_KINMU_ADDRESS_2 AS newKinmuchi2,
		a.NEW_KINMU_ADDRESS_3 AS
		newKinmuchi3,
		a.SHINSEI_RIYU AS riyu,
		a.IDO_YMD AS idoYmd,
		a.ITEN_YMD AS
		itenYmd,
		a.TENNYU_YMD AS tennyuYmd,
		a.RIYO_START_YMD AS
		riyoStartYmd,
		a.SHINSEI_YMD AS shinseiYmd,
		a.SASHIMODOSHI_YMD AS ssmdsYmd,
		a.MOSHIOKURI_COMMENT AS moComment,

		b.KEIRO_SEQ AS keiroSeq,
		b.TSUKIN_SHUDAN_KBN AS tsukinShudan,
		b.SHINSEI_KM AS shinseiKm,
		b.TSUKI_SHIKYU_KIN AS tsuki,
		b.FIRST_SHIKYU_YMD AS firstShikyuYmd,
		b.START_PLACE AS startPlace,
		b.END_PLACE AS endPlace,
		b.VIA_PLACE_1 AS
		viaPlace1,
		b.VIA_PLACE_2 AS viaPlace2,
		b.VIA_PLACE_3 AS viaPlace3,
		b.VIA_PLACE_4 AS viaPlace4,
		b.VIA_PLACE_5 AS viaPlace5,
		b.KATAMICHI_KIN
		AS katamichi,
		b.JITSU_KINMU_NISSU AS jitsu,
		b.FIRST_TEIKI_TSUKI_SU AS
		firstTeikiTsukiSu,
		b.NEXT_TEIKI_TSUKI_SU AS nextTeikiTsukiSu,
		b.IDO_SHUDAN_ETC_NM AS idoShudanEtcNm,
		b.BUS_CORP_NM AS busCorpNm,
		b.SANSHO_TEIKI_KIN_1 AS sanshoTeikiKin1,

		c.FILE_UID_1 AS fileUid1,
		c.HOKEN_MANRYO_YMD AS manryoYmd,
		c.TAIJIN_BAISHO AS taijin,
		c.TAIBUTSU_BAISHO AS taibutsu,
		c.JINSHIN_SHOGAI AS jinshin,
		c.TOJOSHA_SHOGAI AS tojosha,
		c.TOKYU AS tokyu,

		d.CODE_NM AS shinseiName,
		e.CODE_NM AS codeNm,
		f.CODE_NM AS shudanName

		FROM SHINSEI a

		LEFT JOIN
		SHINSEI_START_KEIRO b
		ON a.KIGYO_CD = b.KIGYO_CD
		AND a.SHINSEI_NO =
		b.SHINSEI_NO

		LEFT JOIN SHINSEI_FUZUI_SHORUI c
		ON a.KIGYO_CD = c.KIGYO_CD
		AND a.SHINSEI_NO = c.SHINSEI_NO

		INNER JOIN CODE d
		ON d.CODE_SYBTSU =
		'101'
		AND d.CODE = a.SHINSEI_KBN

		INNER JOIN CODE e
		ON e.CODE_SYBTSU =
		'102'
		AND e.CODE = a.SHINCHOKU_KBN

		INNER JOIN CODE f
		ON f.CODE_SYBTSU =
		'103'
		AND f.CODE = b.TSUKIN_SHUDAN_KBN

		WHERE a.KIGYO_CD = #{kigyoCd}
		AND
		a.SHINSEI_NO = #{shinseiNo}

	</select>

	<select id="getShainUidByShinseiNo" parameterType="String"
		resultType="String">
		SELECT SHAIN_UID
		FROM SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}
	</select>

	<select id="getKigyoCdByShinseiNo" parameterType="Long"
		resultType="Long">
		SELECT KIGYO_CD
		FROM SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}
	</select>


	<select id="getShainByUid" parameterType="String"
		resultType="org.cosmo.domain.ShainVO">
		SELECT
		KIGYO_CD AS kigyo_Cd,
		SHAIN_UID AS shain_Uid,
		SHAIN_NO
		AS shain_No,
		SHAIN_NM AS shain_Nm,
		SHOZOKU_CD AS shozoku_Cd
		FROM SHAIN
		WHERE SHAIN_UID = #{shainUid}
	</select>



	<select id="getFileName" parameterType="Long"
		resultType="String">
		SELECT f.NAME
		FROM SHINSEI s
		JOIN UPLOAD_FILE f
		ON
		s.ETC_FILE_UID_1 = f.FILE_UID
		WHERE s.SHINSEI_NO = #{shinseiNo}
	</select>


	<select id="getCodeNm" parameterType="String"
		resultType="String">
		SELECT CODE_NM
		FROM CODE
		WHERE CODE_SYBTSU = '102'
		AND CODE =
		#{code}
	</select>

	<select id="getShudanName" parameterType="String"
		resultType="String">
		SELECT CODE_NM
		FROM CODE
		WHERE CODE_SYBTSU = '103'
		AND CODE =
		#{code}
	</select>

	<select id="getShinseiName" parameterType="String"
		resultType="String">
		SELECT CODE_NM
		FROM CODE
		WHERE CODE_SYBTSU = '101'
		AND CODE =
		#{code}
	</select>

	<select id="getShinchokuKbn" parameterType="String"
		resultType="String">
		SELECT SHINCHOKU_KBN
		FROM SHINSEI
		WHERE SHINSEI_NO =
		#{shinseiNo}
	</select>


	<update id="updateTorikesu" parameterType="map">
		UPDATE SHINSEI
		SET
		TORIKESHI_RIYU = #{tkComment},
		SHINCHOKU_KBN = '5',
		TORIKESHI_YMD =
		TO_CHAR(SYSDATE, 'YYYYMMDD'),
		UPD_DATE = SYSTIMESTAMP,
		UPD_USER_ID =
		#{shainUid}
		WHERE SHINSEI_NO =
		#{shinseiNo}
	</update>

	<delete id="deleteIchijiHozonByHozonUid" parameterType="String">
		DELETE
		FROM ICHIJI_HOZON
		WHERE HOZON_UID = #{hozonUid}
	</delete>


	<select id="getIchijiHozon" parameterType="String"
		resultType="org.cosmo.domain.ShinseiIcHozonVO">

		SELECT
		HOZON_UID AS hozonUid,
		USER_UID AS userUid,
		SHINSEI_KBN AS shinseiKbn,
		ACTION_NM AS actionNm,
		DATA AS data,
		TO_CHAR(ADD_DATE, 'YYYYMMDD') AS addDate
		FROM
		ICHIJI_HOZON
		WHERE
		HOZON_UID =
		#{hozonUid}
	</select>


	<insert id="insertOshirase" parameterType="map">
		INSERT INTO OSHIRASE (
		KIGYO_CD,
		SHAIN_UID,
		SHAIN_NO,
		TSUCHI_YMD,
		TSUCHI_HM,
		TSUCHISHA_KIGYO_CD,
		TSUCHISHA_CD,
		SHINSEI_NO,
		OSHIRASE_NAIYO,
		ADD_USER_ID,
		ADD_DATE,
		UPD_USER_ID,
		UPD_DATE
		) VALUES (
		#{shinseiUser.kigyo_Cd},
		#{shinseiUser.shain_Uid},
		#{shinseiUser.shain_No},
		TO_CHAR(SYSDATE,'YYYYMMDD'),
		TO_CHAR(SYSDATE,'HH24MI'),
		#{loginUser.kigyo_Cd},
		#{loginUser.shain_No},
		#{shinseiNo},
		'申請を取り消しました',
		#{loginUser.shain_Uid},
		SYSTIMESTAMP,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP
		)
	</insert>

	<select id="getNextLogSeq" resultType="long">
		SELECT NVL(MAX(LOG_SEQ),
		0) + 1
		FROM SHINSEI_LOG
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertShinseiLog">
		INSERT INTO SHINSEI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		LOG_SEQ,
		SYORI_KBN,
		SHINSEI_KBN,
		SHINSEI_YMD,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		#{logSeq},
		#{syoriKbn},
		#{shinseiKbn},
		#{shinseiYmd},
		#{shainUid}
		)
	</insert>

	<delete id="deleteShinseiByShinseiNo" parameterType="String">
		DELETE FROM
		SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}
	</delete>

	<select id="getEmailByShainUid" parameterType="String"
		resultType="string">
		SELECT MAIL_ADDR
		FROM SHAIN
		WHERE SHAIN_UID = #{shainUid}
	</select>


	<select id="countStartKeiro" resultType="int">
		SELECT COUNT(*)
		FROM
		SHINSEI_START_KEIRO
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertStartKeiroLog">
		INSERT INTO SHINSEI_START_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID,
		START_PLACE,
		END_PLACE
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		#{logSeq},
		#{syoriKbn},
		#{shainUid},
		START_PLACE,
		END_PLACE
		FROM SHINSEI_START_KEIRO
		WHERE
		KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</insert>

	<insert id="insertEmptyStartKeiroLog">
		INSERT INTO SHINSEI_START_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		0,
		#{logSeq},
		#{syoriKbn},
		#{shainUid}
		)
	</insert>

	<select id="countEndKeiro" resultType="int">
		SELECT COUNT(*)
		FROM
		SHINSEI_END_KEIRO
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertEndKeiroLog">
		INSERT INTO SHINSEI_END_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID,
		RIYO_END_YMD
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		#{logSeq},
		#{syoriKbn},
		#{shainUid},
		RIYO_END_YMD
		FROM SHINSEI_END_KEIRO
		WHERE KIGYO_CD = #{kigyoCd}
		AND
		SHINSEI_NO = #{shinseiNo}
	</insert>

	<insert id="insertEmptyEndKeiroLog">
		INSERT INTO SHINSEI_END_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		0,
		#{logSeq},
		#{syoriKbn},
		#{shainUid}
		)
	</insert>

	<select id="countFuzuiShorui" resultType="int">
		SELECT COUNT(*)
		FROM
		SHINSEI_FUZUI_SHORUI
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertFuzuiShoruiLog">
		INSERT INTO SHINSEI_FUZUI_SHORUI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID,
		FILE_UID_1,
		FILE_UID_2,
		FILE_UID_3
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		#{logSeq},
		#{syoriKbn},
		#{shainUid},
		FILE_UID_1,
		FILE_UID_2,
		FILE_UID_3
		FROM
		SHINSEI_FUZUI_SHORUI
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</insert>

	<insert id="insertEmptyFuzuiShoruiLog">
		INSERT INTO SHINSEI_FUZUI_SHORUI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		0,
		#{logSeq},
		#{syoriKbn},
		#{shainUid}
		)
	</insert>

	<insert id="insertProcessLog">
		INSERT INTO PROCESS_LOG (
		PROCESS_TIMESTAMP,
		SUBSYSTEM_ID,
		PROCESS_COL,
		KEY1,
		KEY2,
		KEY3,
		KEY4,
		USER_UID
		)
		VALUES (
		SYSTIMESTAMP,
		'SHN',
		#{type},
		#{shinseiNo},
		(SELECT SHINSEI_KBN
		FROM
		SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}),
		(SELECT
		SHINCHOKU_KBN
		FROM
		SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}),
		CASE
		WHEN
		#{type} = 'CANCEL'
		THEN '5'
		ELSE (SELECT SHINCHOKU_KBN
		FROM SHINSEI
		WHERE SHINSEI_NO =
		#{shinseiNo})
		END,
		#{userUid}
		)
	</insert>




	<!-- 제교 -->

	<update id="updateShinseiToIchijihozon">
		UPDATE SHINSEI
		SET SHINCHOKU_KBN = '1', -- 一時保存中
		UPD_USER_ID = #{updUserId, jdbcType=VARCHAR},
		UPD_DATE = SYSDATE
		WHERE
		KIGYO_CD =
		#{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</update>

	<update id="updateAlertForHikimodoshi">
		UPDATE ALERT
		SET SHINSEI_YMD = NULL,
		UPD_USER_ID =
		#{loginUserId},
		UPD_DATE = SYSDATE
		WHERE KIGYO_CD = #{kigyoCd}
		AND
		SHINSEI_NO = #{shinseiNo}
	</update>

	<update id="clearHenkoFlags">
		UPDATE SHINSEI
		SET ADDRESS_CHG_KBN = NULL,
		KINMU_ADDRESS_CHG_KBN = NULL
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO
		= #{shinseiNo}
	</update>

	<update id="updateForResubmit">
		UPDATE SHINSEI
		SET
		SHINSEI_RIYU = #{shinseiRiyu},
		SHINCHOKU_KBN = '2',
		UPD_USER_ID = #{updUserId},
		UPD_DATE = SYSTIMESTAMP
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</update>


	<update id="updateShinseiForReapply" parameterType="map">
		UPDATE
		SHINSEI
		SET SHINSEI_RIYU = #{shinseiRiyu},
		NEW_ZIP_CD = #{newZipCd},
		NEW_ADDRESS_1 = #{newAddress1},
		NEW_ADDRESS_2 = #{newAddress2},
		NEW_ADDRESS_3 = #{newAddress3},
		ADDRESS_IDO_KEIDO = #{addressIdoKeido},
		ADDRESS_CHG_KBN = #{addressChgKbn},
		KINMU_ADDRESS_IDO_KEIDO =
		#{kinmuAddressIdoKeido},
		KINMU_ADDRESS_CHG_KBN = #{kinmuAddressChgKbn},
		SHINCHOKU_KBN = '2',
		UPD_USER_ID =
		#{updUserId, jdbcType=NUMERIC},
		UPD_DATE = SYSTIMESTAMP
		WHERE KIGYO_CD =
		#{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</update>







	<update id="updateStartKeiroForReapply">
		UPDATE SHINSEI_START_KEIRO
		SET JITSU_KINMU_NISSU =
		#{jitsuKinmuNissu, jdbcType=NUMERIC}
		, UPD_USER_ID = #{updUserId,
		jdbcType=NUMERIC}
		,
		UPD_DATE =
		SYSTIMESTAMP
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</update>


	<update id="updateEndKeiroForReapply" parameterType="map">
		UPDATE
		SHINSEI_END_KEIRO
		SET KIKAN_START_YMD = NULL,
		KIKAN_END_YMD = NULL,
		JITSU_KINMU_NISSU = NULL,
		SHINSEI_KIN = NULL,
		JR_MODOSHI_KBN = NULL,
		MODOSHI_KIN = NULL,
		MODOSHI_FILE_UID = NULL,
		UPD_USER_ID =
		#{loginUserId},
		UPD_DATE = SYSDATE
		WHERE KIGYO_CD = #{kigyoCd}
		AND
		SHINSEI_NO = #{shinseiNo}
		AND KEIRO_SEQ = #{keiroSeq}
	</update>



	<select id="selectShinseiDetail"
		resultType="org.cosmo.domain.ShinseiDetailVO">
		SELECT
		a.KIGYO_CD AS kigyoCd,
		a.SHINSEI_NO AS shinseiNo,

		a.SHINCHOKU_KBN AS shinchokuKbn,
		e.CODE_NM AS joutaiName,
		a.SHINSEI_YMD
		AS shinseiYmd,
		a.SASHIMODOSHI_YMD AS sashimodoshiYmd,

		TO_DATE(a.FIRST_SHINSEI_YMD, 'YYYYMMDD') AS saishinseiDate,
		TO_DATE(a.KIGYO_SHONIN_YMD, 'YYYYMMDD') AS shoninDate,
		TO_DATE(a.RIYO_START_YMD, 'YYYYMMDD') AS shikyuuKaishiDate,

		a.MOSHIOKURI_COMMENT AS honninComment,

		a.SHINSEI_KBN AS shinseiKbn,
		d.CODE_NM AS shinseiKbnName,
		a.SHINSEI_RIYU AS shinseiRiyu,

		(a.GEN_ADDRESS_1 || a.GEN_ADDRESS_2 || a.GEN_ADDRESS_3) AS genAddress,
		(a.NEW_ADDRESS_1 || a.NEW_ADDRESS_2 || a.NEW_ADDRESS_3) AS newAddress,

		a.GEN_SHOZOKU_CD AS shozokuBeforeNm,
		a.NEW_SHOZOKU_CD AS
		shozokuAfterNm,

		(a.GEN_KINMU_ADDRESS_1 || a.GEN_KINMU_ADDRESS_2 ||
		a.GEN_KINMU_ADDRESS_3) AS kinmuchiBefore,
		(a.NEW_KINMU_ADDRESS_1 ||
		a.NEW_KINMU_ADDRESS_2 ||
		a.NEW_KINMU_ADDRESS_3) AS kinmuchiAfter,

		TO_DATE(a.IDO_YMD, 'YYYYMMDD') AS idouDate,
		TO_DATE(a.TENNYU_YMD,
		'YYYYMMDD') AS tennyuDate,
		TO_DATE(a.RIYO_START_YMD,'YYYYMMDD') AS
		kaishiDate,

		b.KEIRO_SEQ AS keiroSeq,
		b.TSUKIN_SHUDAN_KBN AS
		tsukinShudanKbn,
		f.CODE_NM AS tsukinShudanName,

		(b.START_PLACE || ' -> '
		|| b.END_PLACE) AS keiro,
		b.START_PLACE AS startPlace,
		b.END_PLACE AS
		endPlace,

		b.SHINSEI_KM AS kyori,
		b.TSUKI_SHIKYU_KIN AS kingakuMonth,
		b.YURYO_DAI_ATO AS yuryodouroMonth,
		b.KATAMICHI_KIN AS katamichi,

		b.YURYO_KATAMICHI_KIN AS yuryoKatamichiKin,

		b.SANSHO_TEIKI_TSUKI_SU_1
		AS sanshoTeikiTsukiSu1,
		b.SANSHO_TEIKI_KIN_1 AS sanshoTeikiKin1,
		b.SANSHO_TEIKI_TSUKI_SU_2 AS sanshoTeikiTsukiSu2,
		b.SANSHO_TEIKI_KIN_2
		AS sanshoTeikiKin2,
		b.SANSHO_TEIKI_TSUKI_SU_3 AS sanshoTeikiTsukiSu3,
		b.SANSHO_TEIKI_KIN_3 AS sanshoTeikiKin3,

		b.YURYO_IC_S AS yuryoIcS,
		b.YURYO_IC_E AS yuryoIcE,

		NVL(c.NENPI, b.NENPI) AS nenpi,


		c.FILE_UID_1
		AS fileUid1,

		TO_DATE(c.MENKYO_YUKO_KIGEN, 'YYYYMMDD') AS
		menkyoYukoKigen,
		c.MENKYO_NO AS menkyoNo,
		c.SHASHU AS shashu,
		c.TOROKU_NO AS torokuNo,
		c.HAIKIRYO AS haikiryo,
		TO_DATE(c.SHAKEN_YUKO_KIGEN, 'YYYYMMDD') AS shakenYukoKigen,

		TO_DATE(c.HOKEN_MANRYO_YMD, 'YYYYMMDD') AS hokenManryoDate,
		c.TAIJIN_BAISHO AS taijinBaisho,
		c.TAIBUTSU_BAISHO AS taibutsuBaisho,
		c.JINSHIN_SHOGAI AS jinshinShogai,
		c.TOJOSHA_SHOGAI AS tojoshaShogai,
		c.TOKYU AS tokyu,
		c.FIRST_TEIKI_KIKAN AS firstTeikiKikan,
		c.NEXT_TEIKI_KIKAN AS nextTeikiKikan

		FROM
		SHINSEI a
		LEFT JOIN
		SHINSEI_START_KEIRO b
		ON a.KIGYO_CD = b.KIGYO_CD
		AND a.SHINSEI_NO =
		b.SHINSEI_NO
		LEFT JOIN SHINSEI_FUZUI_SHORUI c
		ON a.KIGYO_CD = c.KIGYO_CD
		AND a.SHINSEI_NO = c.SHINSEI_NO
		AND b.KEIRO_SEQ = c.KEIRO_SEQ
		LEFT JOIN
		CODE d
		ON d.CODE_SYBTSU = '101'
		AND d.CODE = a.SHINSEI_KBN
		LEFT JOIN CODE
		e
		ON e.CODE_SYBTSU = '102'
		AND e.CODE = a.SHINCHOKU_KBN
		LEFT JOIN CODE f
		ON f.CODE_SYBTSU = '103'
		AND f.CODE = b.TSUKIN_SHUDAN_KBN

		WHERE
		a.KIGYO_CD = #{kigyoCd}
		AND a.SHINSEI_NO = #{shinseiNo}
	</select>



	<select id="getShinseiShorui" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiShoruiVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		SHINSEI_KBN AS shinseiKbn,
		SHINSEI_YMD AS
		shinseiYmd,
		SHAIN_UID AS shainUid,
		SHAIN_NO AS shainNo,
		DAIRI_SHINSEISHA_CD AS dairiShinseishaCd,
		TSUKIN_SHUDAN_KBN AS
		tsukinShudanKbn,
		MENKYO_YUKO_KIGEN AS menkyoYukoKigen,
		MENKYO_NO AS
		menkyoNo,
		SHASHU AS
		shashu,
		TOROKU_NO AS torokuNo,
		HAIKIRYO AS haikiryo,
		SHAKEN_YUKO_KIGEN AS
		shakenYukoKigen,
		NENPI AS nenpi,

		HOKEN_MANRYO_YMD AS
		hokenManryoYmd,
		TAIJIN_BAISHO AS taijinBaisho,
		TAIBUTSU_BAISHO AS
		taibutsuBaisho,
		JINSHIN_SHOGAI AS jinshinShogai,
		TOJOSHA_SHOGAI AS
		tojoshaShogai,
		TOKYU
		AS tokyu,

		FIRST_TEIKI_KIKAN AS firstTeikiKikan,
		NEXT_TEIKI_KIKAN AS
		nextTeikiKikan,
		ADD_USER_ID AS addUserId,
		ADD_DATE AS
		addDate,
		UPD_USER_ID AS updUserId,
		UPD_DATE AS updDate,
		FILE_UID_1 AS
		fileUid1,
		FILE_UID_2 AS fileUid2,
		FILE_UID_3 AS fileUid3,
		FILE_UID_4 AS
		fileUid4,
		FILE_UID_5 AS fileUid5
		FROM
		SHINSEI_FUZUI_SHORUI
		WHERE
		SHINSEI_NO = #{shinseiNo}
		AND KEIRO_SEQ = 1
	</select>





	<insert id="insertOshiraseHikimodosu" parameterType="map">
		INSERT INTO
		OSHIRASE (
		KIGYO_CD,
		SHAIN_UID,
		SHAIN_NO,
		TSUCHI_YMD,
		TSUCHI_HM,
		TSUCHISHA_KIGYO_CD,
		TSUCHISHA_CD,
		SHINSEI_NO,
		OSHIRASE_NAIYO,
		KENGEN,
		ADD_USER_ID,
		ADD_DATE,
		UPD_USER_ID,
		UPD_DATE
		) VALUES (
		#{shinseiUser.kigyo_Cd},
		#{shinseiUser.shain_Uid},
		#{shinseiUser.shain_No},
		TO_CHAR(SYSDATE,'YYYYMMDD'),
		TO_CHAR(SYSDATE,'HH24MI'),
		#{loginUser.kigyo_Cd},
		#{loginUser.shain_No},
		#{shinseiNo},
		'引き戻し',
		NULL,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP
		)
	</insert>


	<insert id="insertOshiraseReapply" parameterType="map">
		INSERT INTO
		OSHIRASE (
		KIGYO_CD,
		SHAIN_UID,
		SHAIN_NO,
		TSUCHI_YMD,
		TSUCHI_HM,
		TSUCHISHA_KIGYO_CD,
		TSUCHISHA_CD,
		SHINSEI_NO,
		OSHIRASE_NAIYO,
		KENGEN,
		ADD_USER_ID,
		ADD_DATE,
		UPD_USER_ID,
		UPD_DATE
		) VALUES (
		#{shinseiUser.kigyo_Cd},
		#{shinseiUser.shain_Uid},
		#{shinseiUser.shain_No},
		TO_CHAR(SYSDATE,'YYYYMMDD'),
		TO_CHAR(SYSDATE,'HH24MI'),
		#{loginUser.kigyo_Cd},
		#{loginUser.shain_No},
		#{shinseiNo},
		'再申請',
		NULL,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP
		)
	</insert>

	<select id="getShinseiKeiroDetailList" parameterType="map"
		resultType="org.cosmo.domain.ShinseiKeiroDetailVO">

		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		TSUKIN_SHUDAN_KBN AS tsukinShudanKbn,
		START_PLACE AS startPlace,
		END_PLACE AS endPlace,
		SHINSEI_KM AS
		shinseiKm,
		KATAMICHI_KIN AS katamichi,
		TSUKI_SHIKYU_KIN AS tsuki,
		SANSHO_TEIKI_KIN_1 AS sanshoTeikiKin1,
		SANSHO_TEIKI_TSUKI_SU_1 AS
		sanshoTeikiTsukiSu1,
		SANSHO_TEIKI_KIN_2 AS sanshoTeikiKin2,
		SANSHO_TEIKI_TSUKI_SU_2 AS
		sanshoTeikiTsukiSu2,
		SANSHO_TEIKI_KIN_3 AS
		sanshoTeikiKin3,
		SANSHO_TEIKI_TSUKI_SU_3 AS sanshoTeikiTsukiSu3,
		YURYO_IC_S AS yuryoIcS,
		YURYO_IC_E AS yuryoIcE,
		FIRST_TEIKI_TSUKI_SU AS
		firstTeikiKikan,
		NEXT_TEIKI_TSUKI_SU AS nextTeikiKikan
		FROM
		SHINSEI_START_KEIRO
		WHERE KIGYO_CD =
		#{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
		ORDER BY
		KEIRO_SEQ
	</select>


	<select id="getNextShinseiLogSeq" resultType="long">
		SELECT
		NVL(MAX(LOG_SEQ), 0) + 1
		FROM SHINSEI_LOG
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</select>


	<insert id="insertReapplyLog">
		INSERT INTO SHINSEI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		LOG_SEQ,
		SYORI_KBN,
		SHINSEI_KBN,
		SHINSEI_YMD,
		SHINSEI_RIYU,
		TOKU_SHINSEI_RIYU,
		SHAIN_UID,
		SHAIN_NO,
		DAIRI_SHINSEISHA_CD
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		#{logSeq},
		#{syoriKbn},
		SHINSEI_KBN,
		SHINSEI_YMD,
		SHINSEI_RIYU,
		TOKU_SHINSEI_RIYU,
		SHAIN_UID,
		SHAIN_NO,
		DAIRI_SHINSEISHA_CD
		FROM SHINSEI
		WHERE KIGYO_CD = #{kigyoCd}
		AND
		SHINSEI_NO = #{shinseiNo}
	</insert>


	<insert id="insertSaishinseiProcessLog">
		INSERT INTO PROCESS_LOG (
		PROCESS_TIMESTAMP,
		SUBSYSTEM_ID,
		PROCESS_COL,
		KEY1,
		KEY2,
		KEY3,
		KEY4,
		KEY5,
		DATA,
		USER_UID,
		USER_TRACK
		)
		VALUES (
		SYSTIMESTAMP,
		#{subsystemId, jdbcType=VARCHAR},
		#{process, jdbcType=VARCHAR},
		#{key1, jdbcType=VARCHAR},
		#{key2,
		jdbcType=VARCHAR},
		#{key3, jdbcType=VARCHAR},
		#{key4, jdbcType=VARCHAR},
		#{key5, jdbcType=VARCHAR},
		#{data, jdbcType=VARCHAR},
		#{userUid,
		jdbcType=VARCHAR},
		#{userTrack, jdbcType=VARCHAR}
		)
	</insert>





	<resultMap id="shinseiResultMap"
		type="org.cosmo.domain.ShinseiDTO">

		<id column="KIGYO_CD" property="kigyoCd" />
		<id column="SHINSEI_NO" property="shinseiNo" />

		<result column="SHINSEI_KBN" property="shinseiKbn" />
		<result column="SHINSEI_YMD" property="shinseiYmd" />
		<result column="SHINSEI_RIYU" property="shinseiRiyu" />
		<result column="TOKU_SHINSEI_RIYU" property="tokuShinseiRiyu" />
		<result column="SHAIN_UID" property="shainUid" />
		<result column="SHAIN_NO" property="shainNo" />
		<result column="DAIRI_SHINSEISHA_CD"
			property="dairiShinseishaCd" />
		<result column="SHINCHOKU_KBN" property="shinchokuKbn" />
		<result column="GEN_TSUKINRO_END_KBN"
			property="genTsukinroEndKbn" />

		<result column="ADDRESS_CHG_KBN" property="addressChgKbn" />
		<result column="KINMU_ADDRESS_CHG_KBN"
			property="kinmuAddressChgKbn" />
		<result column="KYUSHOKU_HUKKI_KBN" property="kyushokuHukkiKbn" />

		<result column="GEN_SHOZOKU_CD" property="genShozokuCd" />
		<result column="GEN_ZIP_CD" property="genZipCd" />
		<result column="GEN_ADDRESS_1" property="genAddress1" />
		<result column="GEN_ADDRESS_2" property="genAddress2" />
		<result column="GEN_ADDRESS_3" property="genAddress3" />

		<result column="NEW_SHOZOKU_CD" property="newShozokuCd" />
		<result column="NEW_ZIP_CD" property="newZipCd" />
		<result column="NEW_ADDRESS_1" property="newAddress1" />
		<result column="NEW_ADDRESS_2" property="newAddress2" />
		<result column="NEW_ADDRESS_3" property="newAddress3" />
		<result column="ADDRESS_IDO_KEIDO" property="addressIdoKeido" />
		<result column="ADDRESS_CORRECT" property="addressCorrect" />

		<result column="GEN_KINMU_ZIP_CD" property="genKinmuZipCd" />
		<result column="GEN_KINMU_ADDRESS_1"
			property="genKinmuAddress1" />
		<result column="GEN_KINMU_ADDRESS_2"
			property="genKinmuAddress2" />
		<result column="GEN_KINMU_ADDRESS_3"
			property="genKinmuAddress3" />
		<result column="GEN_KINMU_PREF_CD" property="genKinmuPrefCd" />

		<result column="NEW_KINMU_ZIP_CD" property="newKinmuZipCd" />
		<result column="NEW_KINMU_ADDRESS_1"
			property="newKinmuAddress1" />
		<result column="NEW_KINMU_ADDRESS_2"
			property="newKinmuAddress2" />
		<result column="NEW_KINMU_ADDRESS_3"
			property="newKinmuAddress3" />
		<result column="KINMU_ADDRESS_IDO_KEIDO"
			property="kinmuAddressIdoKeido" />
		<result column="KINMU_ADDRESS_CORRECT"
			property="kinmuAddressCorrect" />
		<result column="NEW_KINMU_PREF_CD" property="newKinmuPrefCd" />
		<result column="JUTAKU_KBN" property="jutakuKbn" />

		<result column="ETC_FILE_UID_1" property="etcFileUid1" />
		<result column="ETC_FILE_UID_2" property="etcFileUid2" />
		<result column="ETC_FILE_UID_3" property="etcFileUid3" />
		<result column="ETC_FILE_UID_4" property="etcFileUid4" />
		<result column="ETC_FILE_UID_5" property="etcFileUid5" />
		<result column="ETC_COMMENT_1" property="etcComment1" />
		<result column="ETC_COMMENT_2" property="etcComment2" />
		<result column="ETC_COMMENT_3" property="etcComment3" />
		<result column="ETC_COMMENT_4" property="etcComment4" />
		<result column="ETC_COMMENT_5" property="etcComment5" />

		<result column="RIYO_START_YMD" property="riyoStartYmd" />
		<result column="RIYO_END_YMD" property="riyoEndYmd" />
		<result column="SHIKYU_TEISHI_KBN" property="shikyTeishiKbn" />
		<result column="KANRIID" property="kanriId" />
		<result column="IDO_YMD" property="idoYmd" />
		<result column="ITEN_YMD" property="itenYmd" />
		<result column="TENNYU_YMD" property="tennyuYmd" />
		<result column="HAISHIN_YMD" property="haishinYmd" />
		<result column="KEIRO_HENKO_YMD" property="keiroHenkoYmd" />
		<result column="FIRST_SHINSEI_YMD" property="firstShinseiYmd" />
		<result column="KIGYO_SHONIN_YMD" property="kigyoShoninYmd" />
		<result column="LL_SHONIN_YMD" property="llShoninYmd" />
		<result column="TSUKINRO_NO" property="tsukinroNo" />
		<result column="SASHIMODOSHI_YMD" property="sashimodoshiYmd" />
		<result column="SHINSEI_KIGEN_YMD" property="shinseiKigenYmd" />
		<result column="MOSHIOKURI_COMMENT"
			property="moshiokuriComment" />
		<result column="BIBO_COMMENT" property="biboComment" />
		<result column="ALERT_UMU" property="alertUmu" />
		<result column="TORIKESHI_YMD" property="torikeshiYmd" />
		<result column="TORIKESHI_RIYU" property="torikeshiRiyu" />
		<result column="ICHIJI_HOZON_ID" property="ichijiHozonId" />
		<result column="JITSU_KM" property="jitsuKm" />
		<result column="NAVITIME_VIEW_CNT" property="navitimeViewCnt" />

		<result column="ADD_USER_ID" property="addUserId" />
		<result column="ADD_DATE" property="addDate" />
		<result column="UPD_USER_ID" property="updUserId" />
		<result column="UPD_DATE" property="updDate" />

	</resultMap>







</mapper>