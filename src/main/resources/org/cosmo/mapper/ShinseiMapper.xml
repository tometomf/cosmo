<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.cosmo.mapper.ShinseiMapper">

	<!-- 하나 -->
	<select id="getShinseiJyohou" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiJyohouVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		SHINSEI_KBN AS shinseiKbn,
		SHINCHOKU_KBN AS shinchokuKbn,

		GEN_ADDRESS_1
		AS genAddress1,
		GEN_ADDRESS_2 AS genAddress2,
		GEN_ADDRESS_3 AS
		genAddress3,
		NEW_ADDRESS_1 AS newAddress1,
		NEW_ADDRESS_2 AS newAddress2,
		NEW_ADDRESS_3 AS newAddress3,

		GEN_SHOZOKU_CD AS genShozoku,
		NEW_SHOZOKU_CD AS newShozoku,


		GEN_KINMU_ZIP_CD AS genKinmuZipCd,
		GEN_KINMU_ADDRESS_1 AS genKinmuAddress1,
		GEN_KINMU_ADDRESS_2 AS
		genKinmuAddress2,
		GEN_KINMU_ADDRESS_3 AS genKinmuAddress3,

		NEW_KINMU_ZIP_CD AS newKinmuZipCd,
		NEW_KINMU_ADDRESS_1 AS
		newKinmuAddress1,
		NEW_KINMU_ADDRESS_2 AS newKinmuAddress2,
		NEW_KINMU_ADDRESS_3 AS newKinmuAddress3,

		GEN_KINMU_ADDRESS_1 AS
		genKinmuchi1,
		GEN_KINMU_ADDRESS_2 AS genKinmuchi2,
		GEN_KINMU_ADDRESS_3
		AS genKinmuchi3,
		NEW_KINMU_ADDRESS_1 AS newKinmuchi1,
		NEW_KINMU_ADDRESS_2 AS newKinmuchi2,
		NEW_KINMU_ADDRESS_3 AS
		newKinmuchi3,
		ETC_COMMENT_1 AS etcComment1,
		ETC_COMMENT_2 AS
		etcComment2,
		ETC_COMMENT_3 AS etcComment3,
		ETC_COMMENT_4 AS etcComment4,
		ETC_COMMENT_5 AS etcComment5,
		ETC_FILE_UID_1 AS etcFileUid1,
		ETC_FILE_UID_2 AS
		etcFileUid2,
		ETC_FILE_UID_3 AS etcFileUid3,
		ETC_FILE_UID_4 AS
		etcFileUid4,
		ETC_FILE_UID_5 AS etcFileUid5,
		KINMU_ADDRESS_IDO_KEIDO AS kinmuAddressIdoKeido,
		SHINSEI_RIYU AS riyu,
		IDO_YMD AS idoYmd,
		ITEN_YMD AS itenYmd,
		TENNYU_YMD
		AS tennyuYmd,
		RIYO_START_YMD AS
		riyoStartYmd,
		SHINSEI_YMD AS shinseiYmd,
		SASHIMODOSHI_YMD AS ssmdsYmd,
		MOSHIOKURI_COMMENT AS moComment,
		TORIKESHI_YMD AS torikeshiYmd
		FROM
		SHINSEI
		WHERE SHINSEI_NO =
		#{shinseiNo}
	</select>


	<select id="getShinseiKeiro" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiKeiroVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		TSUKIN_SHUDAN_KBN AS tsukinShudan,
		KATAMICHI_KIN
		AS katamichi,
		JITSU_KINMU_NISSU AS jitsu,
		TSUKI_SHIKYU_KIN AS tsuki,
		SHINSEI_KM AS shinseiKm,
		START_PLACE AS startPlace,
		YURYO_IC_S AS
		yuryoIcS,
		YURYO_IC_E AS yuryoIcE,
		END_PLACE AS
		endPlace
		FROM
		SHINSEI_START_KEIRO
		WHERE SHINSEI_NO = #{shinseiNo}
		AND KEIRO_SEQ = 1
	</select>

	<select id="getShinseiView" parameterType="map"
		resultMap="shinseiViewMap">
		SELECT
		a.KIGYO_CD AS kigyoCd,
		a.SHINSEI_NO AS shinseiNo,
		a.SHINSEI_YMD AS shinseiYmd,
		a.SHINSEI_KBN AS shinseiKbn,
		a.SHINCHOKU_KBN AS shinchokuKbn,
		a.GEN_ADDRESS_1 AS genAddress1,
		a.GEN_ADDRESS_2 AS genAddress2,
		a.GEN_ADDRESS_3 AS genAddress3,
		a.NEW_ADDRESS_1 AS newAddress1,
		a.NEW_ADDRESS_2 AS newAddress2,
		a.NEW_ADDRESS_3 AS newAddress3,
		a.GEN_SHOZOKU_CD AS genShozoku,
		a.NEW_SHOZOKU_CD AS newShozoku,
		a.GEN_KINMU_ADDRESS_1 AS genKinmuchi1,
		a.GEN_KINMU_ADDRESS_2 AS genKinmuchi2,
		a.GEN_KINMU_ADDRESS_3 AS
		genKinmuchi3,
		a.NEW_KINMU_ADDRESS_1 AS newKinmuchi1,
		a.NEW_KINMU_ADDRESS_2 AS newKinmuchi2,
		a.NEW_KINMU_ADDRESS_3 AS
		newKinmuchi3,
		a.SHINSEI_RIYU AS riyu,
		a.IDO_YMD AS idoYmd,
		a.ITEN_YMD AS
		itenYmd,
		a.TENNYU_YMD AS tennyuYmd,
		a.RIYO_START_YMD AS
		riyoStartYmd,
		a.SHINSEI_YMD AS shinseiYmd,
		a.SASHIMODOSHI_YMD AS ssmdsYmd,
		a.MOSHIOKURI_COMMENT AS moComment,
		C.KEIRO_SEQ AS shoruiKeiroSeq,
		c.FILE_UID_1 AS fileUid1,
		c.HOKEN_MANRYO_YMD AS
		manryoYmd,
		c.TAIJIN_BAISHO AS taijin,
		c.TAIBUTSU_BAISHO AS taibutsu,
		c.JINSHIN_SHOGAI AS jinshin,
		c.TOJOSHA_SHOGAI AS tojosha,
		c.TOKYU AS
		tokyu,
		b.KEIRO_SEQ AS keiroSeq,
		b.TSUKIN_SHUDAN_KBN AS tsukinShudan,
		b.SHINSEI_KM AS shinseiKm,
		b.TSUKI_SHIKYU_KIN AS tsuki,
		b.FIRST_SHIKYU_YMD AS firstShikyuYmd,
		b.START_PLACE AS startPlace,
		b.END_PLACE AS endPlace,
		b.VIA_PLACE_1 AS
		viaPlace1,
		b.VIA_PLACE_2 AS
		viaPlace2,
		b.VIA_PLACE_3 AS viaPlace3,
		b.VIA_PLACE_4 AS viaPlace4,
		b.VIA_PLACE_5 AS viaPlace5,
		b.KATAMICHI_KIN
		AS katamichi,
		b.JITSU_KINMU_NISSU AS jitsu,
		b.FIRST_TEIKI_TSUKI_SU AS
		firstTeikiTsukiSu,
		b.NEXT_TEIKI_TSUKI_SU AS nextTeikiTsukiSu,
		b.IDO_SHUDAN_ETC_NM AS idoShudanEtcNm,
		b.BUS_CORP_NM AS busCorpNm,
		b.SANSHO_TEIKI_KIN_1 AS sanshoTeikiKin1,

		d.CODE_NM AS shinseiName,
		e.CODE_NM AS codeNm,
		f.CODE_NM AS
		shudanName,

		uf.NAME AS ufName
		FROM
		SHINSEI a

		LEFT JOIN
		SHINSEI_START_KEIRO b
		ON a.KIGYO_CD =
		b.KIGYO_CD
		AND
		a.SHINSEI_NO =
		b.SHINSEI_NO

		LEFT JOIN SHINSEI_FUZUI_SHORUI
		c
		ON a.KIGYO_CD
		= c.KIGYO_CD
		AND a.SHINSEI_NO = c.SHINSEI_NO
		AND
		c.KEIRO_SEQ =
		b.KEIRO_SEQ

		LEFT JOIN
		CODE d
		ON d.CODE_SYBTSU =
		'101'
		AND
		d.CODE =
		a.SHINSEI_KBN

		LEFT JOIN CODE e
		ON e.CODE_SYBTSU =
		'102'
		AND
		e.CODE =
		a.SHINCHOKU_KBN

		LEFT JOIN CODE f
		ON
		f.CODE_SYBTSU =
		'103'
		AND
		f.CODE =
		b.TSUKIN_SHUDAN_KBN

		LEFT JOIN UPLOAD_FILE uf
		ON c.FILE_UID_1 =
		uf.FILE_UID

		WHERE a.KIGYO_CD =
		#{kigyoCd}
		AND
		a.SHINSEI_NO = #{shinseiNo}
		ORDER BY b.KEIRO_SEQ
	</select>

	<resultMap id="shinseiViewMap"
		type="org.cosmo.domain.ShinseiViewDTO">

		<id property="shinseiNo" column="shinseiNo" />

		<result property="kigyoCd" column="kigyoCd" />
		<result property="shinseiYmd" column="shinseiYmd" />
		<result property="shinseiKbn" column="shinseiKbn" />
		<result property="shinchokuKbn" column="shinchokuKbn" />
		<result property="genAddress1" column="genAddress1" />
		<result property="genAddress2" column="genAddress2" />
		<result property="genAddress3" column="genAddress3" />
		<result property="newAddress1" column="newAddress1" />
		<result property="newAddress2" column="newAddress2" />
		<result property="newAddress3" column="newAddress3" />
		<result property="genShozoku" column="genShozoku" />
		<result property="newShozoku" column="newShozoku" />
		<result property="genKinmuchi1" column="genKinmuchi1" />
		<result property="genKinmuchi2" column="genKinmuchi2" />
		<result property="genKinmuchi3" column="genKinmuchi3" />
		<result property="newKinmuchi1" column="newKinmuchi1" />
		<result property="newKinmuchi2" column="newKinmuchi2" />
		<result property="newKinmuchi3" column="newKinmuchi3" />
		<result property="riyu" column="riyu" />
		<result property="idoYmd" column="idoYmd" />
		<result property="itenYmd" column="itenYmd" />
		<result property="tennyuYmd" column="tennyuYmd" />
		<result property="riyoStartYmd" column="riyoStartYmd" />
		<result property="ssmdsYmd" column="ssmdsYmd" />
		<result property="moComment" column="moComment" />

		<result property="shinseiName" column="shinseiName" />
		<result property="codeNm" column="codeNm" />
		<result property="shudanName" column="shudanName" />

		<collection property="shoruiList"
			ofType="org.cosmo.domain.ShinseiShoruiVO">
			<id property="keiroSeq" column="shoruiKeiroSeq" />
			<result property="fileUid1" column="fileUid1" />
			<result property="manryoYmd" column="manryoYmd" />
			<result property="taijin" column="taijin" />
			<result property="taibutsu" column="taibutsu" />
			<result property="jinshin" column="jinshin" />
			<result property="tojosha" column="tojosha" />
			<result property="tokyu" column="tokyu" />
		</collection>

		<collection property="keiroList"
			ofType="org.cosmo.domain.ShinseiKeiroVO">
			<id property="keiroSeq" column="keiroSeq" />
			<result property="tsukinShudan" column="tsukinShudan" />
			<result property="shinseiKm" column="shinseiKm" />
			<result property="tsuki" column="tsuki" />
			<result property="firstShikyuYmd" column="firstShikyuYmd" />
			<result property="startPlace" column="startPlace" />
			<result property="endPlace" column="endPlace" />
			<result property="viaPlace1" column="viaPlace1" />
			<result property="viaPlace2" column="viaPlace2" />
			<result property="viaPlace3" column="viaPlace3" />
			<result property="viaPlace4" column="viaPlace4" />
			<result property="viaPlace5" column="viaPlace5" />
			<result property="katamichi" column="katamichi" />
			<result property="jitsu" column="jitsu" />
			<result property="firstTeikiTsukiSu"
				column="firstTeikiTsukiSu" />
			<result property="nextTeikiTsukiSu" column="nextTeikiTsukiSu" />
			<result property="idoShudanEtcNm" column="idoShudanEtcNm" />
			<result property="busCorpNm" column="busCorpNm" />
			<result property="sanshoTeikiKin1" column="sanshoTeikiKin1" />
			<result property="shudanName" column="shudanName" />
		</collection>

	</resultMap>

	<select id="getShainUidByShinseiNo" parameterType="String"
		resultType="String">
		SELECT SHAIN_UID
		FROM SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}
	</select>

	<select id="getKigyoCdByShinseiNo" parameterType="Long"
		resultType="Long">
		SELECT KIGYO_CD
		FROM SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}
	</select>

	<select id="getShinseiKeiroList" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiKeiroVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		TSUKIN_SHUDAN_KBN AS tsukinShudan,
		KATAMICHI_KIN
		AS katamichi,
		JITSU_KINMU_NISSU AS jitsu,
		TSUKI_SHIKYU_KIN AS tsuki,
		SHINSEI_KM AS shinseiKm,
		START_PLACE AS startPlace,
		END_PLACE AS
		endPlace,
		VIA_PLACE_1 AS viaPlace1,
		VIA_PLACE_2 AS viaPlace2,
		VIA_PLACE_3 AS viaPlace3,
		VIA_PLACE_4 AS viaPlace4,
		VIA_PLACE_5 AS
		viaPlace5
		FROM SHINSEI_START_KEIRO
		WHERE SHINSEI_NO = #{shinseiNo}
		ORDER
		BY KEIRO_SEQ
	</select>

	<select id="getShinseiShoruiList" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiShoruiVO">

		SELECT
		s.KIGYO_CD AS kigyoCd,
		s.SHINSEI_NO AS shinseiNo,
		s.KEIRO_SEQ AS keiroSeq,
		s.HOKEN_MANRYO_YMD AS manryoYmd,
		s.TAIJIN_BAISHO AS taijin,
		s.TAIBUTSU_BAISHO AS taibutsu,
		s.JINSHIN_SHOGAI AS jinshin,
		s.TOJOSHA_SHOGAI AS tojosha,
		s.TOKYU AS
		tokyu,
		s.FILE_UID_1 AS fileUid1,
		s.FILE_UID_2 AS fileUid2,
		s.FILE_UID_3
		AS fileUid3,
		s.FILE_UID_4 AS fileUid4,
		s.FILE_UID_5 AS fileUid5
		FROM
		SHINSEI_FUZUI_SHORUI s
		WHERE s.SHINSEI_NO = #{shinseiNo}
		ORDER BY
		s.KEIRO_SEQ

	</select>


	<select id="getShainByUid" parameterType="String"
		resultType="org.cosmo.domain.ShainVO">
		SELECT
		KIGYO_CD AS kigyo_Cd,
		SHAIN_UID AS shain_Uid,
		SHAIN_NO
		AS shain_No,
		SHAIN_NM AS shain_Nm,
		SHOZOKU_CD AS shozoku_Cd,
		ADDRESS_1 AS
		address1,
		ADDRESS_2 AS address2,
		ADDRESS_3 AS address3,
		KINMU_ADDRESS_1
		AS kinmuAddress1,
		KINMU_ADDRESS_2 AS kinmuAddress2,
		KINMU_ADDRESS_3 AS
		kinmuAddress3
		FROM SHAIN
		WHERE SHAIN_UID = #{shainUid}
	</select>

	<select id="getFileName" parameterType="Long"
		resultType="String">
		SELECT f.NAME
		FROM SHINSEI_FUZUI_SHORUI s
		LEFT JOIN
		UPLOAD_FILE f
		ON s.FILE_UID_1 = f.FILE_UID
		WHERE s.SHINSEI_NO =
		#{shinseiNo}
	</select>


	<select id="getCodeNm" parameterType="String"
		resultType="String">
		SELECT CODE_NM
		FROM CODE
		WHERE CODE_SYBTSU = '102'
		AND CODE =
		#{code}
	</select>

	<select id="getShudanName" parameterType="String"
		resultType="String">
		SELECT CODE_NM
		FROM CODE
		WHERE CODE_SYBTSU = '103'
		AND CODE =
		#{code}
	</select>

	<select id="getShinseiName" parameterType="String"
		resultType="String">
		SELECT CODE_NM
		FROM CODE
		WHERE CODE_SYBTSU = '101'
		AND CODE =
		#{code}
	</select>

	<select id="getShinchokuKbn" parameterType="String"
		resultType="String">
		SELECT SHINCHOKU_KBN
		FROM SHINSEI
		WHERE SHINSEI_NO =
		#{shinseiNo}
	</select>


	<update id="updateTorikesu" parameterType="map">
		UPDATE SHINSEI
		SET
		TORIKESHI_RIYU = #{tkComment},
		SHINCHOKU_KBN = '5',
		TORIKESHI_YMD =
		TO_CHAR(SYSDATE, 'YYYYMMDD'),
		UPD_DATE = SYSTIMESTAMP,
		UPD_USER_ID =
		#{shainUid}
		WHERE SHINSEI_NO =
		#{shinseiNo}
	</update>

	<delete id="deleteIchijiHozonByHozonUid" parameterType="String">
		DELETE
		FROM ICHIJI_HOZON
		WHERE HOZON_UID = #{hozonUid}
	</delete>


	<select id="getIchijiHozon" parameterType="String"
		resultType="org.cosmo.domain.ShinseiIcHozonVO">

		SELECT
		HOZON_UID AS hozonUid,
		USER_UID AS userUid,
		SHINSEI_KBN AS shinseiKbn,
		ACTION_NM AS actionNm,
		DATA AS data,
		TO_CHAR(ADD_DATE, 'YYYYMMDD') AS addDate
		FROM
		ICHIJI_HOZON
		WHERE
		HOZON_UID =
		#{hozonUid}
	</select>


	<insert id="insertOshirase" parameterType="map">
		INSERT INTO OSHIRASE (
		KIGYO_CD,
		SHAIN_UID,
		SHAIN_NO,
		TSUCHI_YMD,
		TSUCHI_HM,
		TSUCHISHA_KIGYO_CD,
		TSUCHISHA_CD,
		SHINSEI_NO,
		OSHIRASE_NAIYO,
		ADD_USER_ID,
		ADD_DATE,
		UPD_USER_ID,
		UPD_DATE
		) VALUES (
		#{shinseiUser.kigyo_Cd},
		#{shinseiUser.shain_Uid},
		#{shinseiUser.shain_No},
		TO_CHAR(SYSDATE,'YYYYMMDD'),
		TO_CHAR(SYSDATE,'HH24MI'),
		#{loginUser.kigyo_Cd},
		#{loginUser.shain_No},
		#{shinseiNo},
		'申請を取り消しました',
		#{loginUser.shain_Uid},
		SYSTIMESTAMP,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP
		)
	</insert>

	<select id="getNextLogSeq" resultType="long">
		SELECT NVL(MAX(LOG_SEQ),
		0) + 1
		FROM SHINSEI_LOG
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertShinseiLog">
		INSERT INTO SHINSEI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		LOG_SEQ,
		SYORI_KBN,
		SHINSEI_KBN,
		SHINSEI_YMD,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		#{logSeq},
		#{syoriKbn},
		#{shinseiKbn},
		#{shinseiYmd},
		#{shainUid}
		)
	</insert>

	<delete id="deleteShinseiByShinseiNo" parameterType="String">
		DELETE FROM
		SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}
	</delete>

	<select id="getEmailByShainUid" parameterType="String"
		resultType="string">
		SELECT MAIL_ADDR
		FROM SHAIN
		WHERE SHAIN_UID = #{shainUid}
	</select>


	<select id="countStartKeiro" resultType="int">
		SELECT COUNT(*)
		FROM
		SHINSEI_START_KEIRO
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertStartKeiroLog">
		INSERT INTO SHINSEI_START_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID,
		START_PLACE,
		END_PLACE
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		#{logSeq},
		#{syoriKbn},
		#{shainUid},
		START_PLACE,
		END_PLACE
		FROM SHINSEI_START_KEIRO
		WHERE
		KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</insert>

	<insert id="insertEmptyStartKeiroLog">
		INSERT INTO SHINSEI_START_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		0,
		#{logSeq},
		#{syoriKbn},
		#{shainUid}
		)
	</insert>

	<select id="countEndKeiro" resultType="int">
		SELECT COUNT(*)
		FROM
		SHINSEI_END_KEIRO
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertEndKeiroLog">
		INSERT INTO SHINSEI_END_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID,
		RIYO_END_YMD
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		#{logSeq},
		#{syoriKbn},
		#{shainUid},
		RIYO_END_YMD
		FROM SHINSEI_END_KEIRO
		WHERE KIGYO_CD = #{kigyoCd}
		AND
		SHINSEI_NO = #{shinseiNo}
	</insert>

	<insert id="insertEmptyEndKeiroLog">
		INSERT INTO SHINSEI_END_KEIRO_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		0,
		#{logSeq},
		#{syoriKbn},
		#{shainUid}
		)
	</insert>

	<select id="countFuzuiShorui" resultType="int">
		SELECT COUNT(*)
		FROM
		SHINSEI_FUZUI_SHORUI
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</select>

	<insert id="insertFuzuiShoruiLog">
		INSERT INTO SHINSEI_FUZUI_SHORUI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID,
		FILE_UID_1,
		FILE_UID_2,
		FILE_UID_3
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		#{logSeq},
		#{syoriKbn},
		#{shainUid},
		FILE_UID_1,
		FILE_UID_2,
		FILE_UID_3
		FROM
		SHINSEI_FUZUI_SHORUI
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</insert>

	<insert id="insertEmptyFuzuiShoruiLog">
		INSERT INTO SHINSEI_FUZUI_SHORUI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		KEIRO_SEQ,
		LOG_SEQ,
		SYORI_KBN,
		SHAIN_UID
		) VALUES (
		#{kigyoCd},
		#{shinseiNo},
		0,
		#{logSeq},
		#{syoriKbn},
		#{shainUid}
		)
	</insert>

	<insert id="insertProcessLog">
		INSERT INTO PROCESS_LOG (
		PROCESS_TIMESTAMP,
		SUBSYSTEM_ID,
		PROCESS_COL,
		KEY1,
		KEY2,
		KEY3,
		KEY4,
		USER_UID
		)
		VALUES (
		SYSTIMESTAMP,
		'SHN',
		#{type},
		#{shinseiNo},
		(SELECT SHINSEI_KBN
		FROM
		SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}),
		(SELECT
		SHINCHOKU_KBN
		FROM
		SHINSEI
		WHERE SHINSEI_NO = #{shinseiNo}),
		CASE
		WHEN
		#{type} = 'CANCEL'
		THEN '5'
		ELSE (SELECT SHINCHOKU_KBN
		FROM SHINSEI
		WHERE SHINSEI_NO =
		#{shinseiNo})
		END,
		#{userUid}
		)
	</insert>




	<!-- 제교 -->

	<update id="updateShinseiToIchijihozon">
		UPDATE SHINSEI
		SET SHINCHOKU_KBN = '1',
		UPD_USER_ID =
		#{updUserId, jdbcType=VARCHAR},
		UPD_DATE = SYSDATE
		WHERE
		KIGYO_CD =
		#{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</update>



	<update id="clearHenkoFlags">
		UPDATE SHINSEI
		SET ADDRESS_CHG_KBN = NULL,
		KINMU_ADDRESS_CHG_KBN = NULL
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO
		= #{shinseiNo}
	</update>

	<update id="updateForResubmit">
		UPDATE SHINSEI
		SET
		SHINSEI_RIYU = #{shinseiRiyu},
		SHINCHOKU_KBN = '2',
		UPD_USER_ID = #{updUserId},
		UPD_DATE = SYSTIMESTAMP
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
	</update>

	<update id="updateShinseiForReapply" parameterType="map">
		UPDATE
		SHINSEI
		SET
		SHINSEI_YMD = TO_CHAR(SYSDATE, 'YYYYMMDD'),
		SHINSEI_RIYU =
		#{shinseiRiyu, jdbcType=VARCHAR},
		TOKU_SHINSEI_RIYU = NULL,
		SHINCHOKU_KBN = '2',

		NEW_SHOZOKU_CD = #{newShozoku, jdbcType=VARCHAR},
		NEW_ZIP_CD = #{newZipCd, jdbcType=CHAR},
		NEW_ADDRESS_1 = #{newAddress1,
		jdbcType=VARCHAR},
		NEW_ADDRESS_2 = #{newAddress2, jdbcType=VARCHAR},
		NEW_ADDRESS_3 = #{newAddress3, jdbcType=VARCHAR},


		ADDRESS_IDO_KEIDO =
		#{addressIdoKeido, jdbcType=VARCHAR},
		ADDRESS_CHG_KBN =
		#{addressChgKbn, jdbcType=CHAR},
		KINMU_ADDRESS_IDO_KEIDO =
		#{kinmuAddressIdoKeido, jdbcType=VARCHAR},
		KINMU_ADDRESS_CHG_KBN =
		#{kinmuAddressChgKbn, jdbcType=CHAR},


		NEW_KINMU_ZIP_CD =
		#{newKinmuZipCd, jdbcType=CHAR},
		NEW_KINMU_ADDRESS_1 =
		#{newKinmuAddress1, jdbcType=VARCHAR},
		NEW_KINMU_ADDRESS_2 =
		#{newKinmuAddress2, jdbcType=VARCHAR},
		NEW_KINMU_ADDRESS_3 =
		#{newKinmuAddress3, jdbcType=VARCHAR},
		NEW_KINMU_PREF_CD =
		#{newKinmuPrefCd, jdbcType=CHAR},

		ETC_FILE_UID_1 =
		#{etcFileUid1,
		jdbcType=NUMERIC},
		ETC_FILE_UID_2 = #{etcFileUid2,
		jdbcType=NUMERIC},
		ETC_FILE_UID_3 = #{etcFileUid3, jdbcType=NUMERIC},
		ETC_FILE_UID_4 =
		#{etcFileUid4, jdbcType=NUMERIC},
		ETC_FILE_UID_5 =
		#{etcFileUid5,
		jdbcType=NUMERIC},

		ETC_COMMENT_1 = #{etcComment1,
		jdbcType=VARCHAR},
		ETC_COMMENT_2 = #{etcComment2, jdbcType=VARCHAR},
		ETC_COMMENT_3 =
		#{etcComment3, jdbcType=VARCHAR},
		ETC_COMMENT_4 =
		#{etcComment4,
		jdbcType=VARCHAR},
		ETC_COMMENT_5 = #{etcComment5,
		jdbcType=VARCHAR},

		RIYO_END_YMD = NULL,
		IDO_YMD = #{idoYmd,
		jdbcType=CHAR},
		ITEN_YMD =
		#{itenYmd, jdbcType=CHAR},
		TENNYU_YMD =
		#{tennyuYmd, jdbcType=CHAR},
		KEIRO_HENKO_YMD = #{keiroHenkoYmd,
		jdbcType=CHAR},
		HAISHIN_YMD = NULL,

		KIGYO_SHONIN_YMD = NULL,
		LL_SHONIN_YMD = NULL,
		TSUKINRO_NO = NULL,
		SASHIMODOSHI_YMD = NULL,
		MOSHIOKURI_COMMENT = NULL,
		BIBO_COMMENT = NULL,
		TORIKESHI_YMD = NULL,
		TORIKESHI_RIYU = NULL,
		ICHIJI_HOZON_ID = NULL,

		UPD_USER_ID =
		#{updUserId, jdbcType=NUMERIC},
		UPD_DATE = SYSTIMESTAMP
		WHERE
		KIGYO_CD = #{kigyoCd, jdbcType=NUMERIC}
		AND SHINSEI_NO =
		#{shinseiNo,
		jdbcType=NUMERIC}
	</update>

	<update id="updateStartKeiroForReapply" parameterType="map">
		UPDATE
		SHINSEI_START_KEIRO
		SET
		TSUKIN_SHUDAN_KBN = #{tsukinShudanKbn,
		jdbcType=VARCHAR},
		TOKUREI_KBN =
		#{tokureiKbn, jdbcType=VARCHAR},
		KIKAN_START_YMD = #{kikanStartYmd,
		jdbcType=VARCHAR},
		KIKAN_END_YMD =
		#{kikanEndYmd, jdbcType=VARCHAR},

		JITSU_KINMU_NISSU =
		#{jitsuKinmuNissu, jdbcType=NUMERIC},

		IDO_SHUDAN_KBN = NULL,
		IDO_SHUDAN_ETC_NM = #{idoShudanEtcNm,
		jdbcType=VARCHAR},

		START_PLACE =
		#{startPlace, jdbcType=VARCHAR},
		END_PLACE = #{endPlace,
		jdbcType=VARCHAR},
		VIA_PLACE_1 = #{viaPlace1,
		jdbcType=VARCHAR},
		VIA_PLACE_2 = #{viaPlace2, jdbcType=VARCHAR},
		VIA_PLACE_3 =
		#{viaPlace3, jdbcType=VARCHAR},
		VIA_PLACE_4 =
		#{viaPlace4,
		jdbcType=VARCHAR},
		VIA_PLACE_5 = #{viaPlace5,
		jdbcType=VARCHAR},
		KEKKA_URL = #{kekkaUrl, jdbcType=VARCHAR},

		SHINSEI_KIN = #{shinseiKin,
		jdbcType=NUMERIC},
		FIRST_TEIKI_TSUKI_SU =
		#{firstTeikiTsukiSu,
		jdbcType=NUMERIC},
		FIRST_SHIKYU_YMD = NULL,
		FIRST_SHIKYU_KIN =
		#{firstShikyuKin, jdbcType=NUMERIC},
		NEXT_TEIKI_TSUKI_SU =
		#{nextTeikiTsukiSu, jdbcType=NUMERIC},
		REGULAR_SHIKYU_KIN =
		#{regularShikyuKin, jdbcType=NUMERIC},
		TSUKI_SHIKYU_KIN =
		#{tsukiShikyuKin, jdbcType=NUMERIC},
		KATAMICHI_KIN =
		#{katamichiKin,
		jdbcType=NUMERIC},

		SHINKANSEN_RIYO_KBN =
		#{shinkansenRiyoKbn,
		jdbcType=VARCHAR},
		TOKKYU_RIYO_KBN =
		#{tokkyuRiyoKbn, jdbcType=VARCHAR},
		YURO_RIYO_KBN = #{yuroRiyoKbn,
		jdbcType=VARCHAR},
		KEKKA_SELECT =
		#{kekkaSelect, jdbcType=VARCHAR},

		SANSHO_TEIKI_TSUKI_SU_1 =
		#{sanshoTeikiTsukiSu1, jdbcType=NUMERIC},
		SANSHO_TEIKI_KIN_1 =
		#{sanshoTeikiKin1, jdbcType=NUMERIC},
		SANSHO_TEIKI_TSUKI_SU_2 =
		#{sanshoTeikiTsukiSu2, jdbcType=NUMERIC},
		SANSHO_TEIKI_KIN_2 =
		#{sanshoTeikiKin2, jdbcType=NUMERIC},
		SANSHO_TEIKI_TSUKI_SU_3 =
		#{sanshoTeikiTsukiSu3, jdbcType=NUMERIC},
		SANSHO_TEIKI_KIN_3 =
		#{sanshoTeikiKin3, jdbcType=NUMERIC},

		SHINSEI_KM =
		#{shinseiKm,
		jdbcType=NUMERIC},
		YURO_IC_S = #{yuroIcS,
		jdbcType=VARCHAR},
		YURO_IC_E =
		#{yuroIcE, jdbcType=VARCHAR},
		YURO_KATAMICHI_KIN = #{yuroKatamichiKin,
		jdbcType=NUMERIC},

		BETSU_ROUTE_RIYU = #{betsuRouteRiyu,
		jdbcType=VARCHAR},
		YURO_RIYO_RIYU
		= #{yuroRiyoRiyu, jdbcType=VARCHAR},
		VIA_PLACE_RIYU = #{viaPlaceRiyu,
		jdbcType=VARCHAR},

		NENPI = #{nenpi,
		jdbcType=NUMERIC},

		UPD_USER_ID =
		#{updUserId, jdbcType=NUMERIC},
		UPD_DATE = SYSTIMESTAMP
		WHERE
		KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
		AND KEIRO_SEQ =
		#{keiroSeq}
	</update>

	<update id="updateEndKeiroForReapply" parameterType="map">
		UPDATE
		SHINSEI_END_KEIRO
		SET
		FUBI_UMU_KBN = NULL,
		RIYO_END_YMD = NULL,
		KIKAN_START_YMD = NULL,
		KIKAN_END_YMD = NULL,
		JITSU_KINMU_NISSU = NULL,
		SHINSEI_KIN = NULL,
		JR_MODOSHI_KBN = NULL,
		MODOSHI_KIN = NULL,
		MODOSHI_FILE_UID = NULL,
		UPD_USER_ID = #{loginUserId},
		UPD_DATE =
		SYSDATE
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
		AND
		KEIRO_SEQ = #{keiroSeq}
	</update>


	<update id="updateShinseiFuzuiShoruiForReapply"
		parameterType="map">
		UPDATE SHINSEI_FUZUI_SHORUI
		SET
		MENKYO_YUKO_KIGEN = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{menkyoYukoKigen}
		ELSE NULL
		END,
		MENKYO_NO = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN
		#{menkyoNo}
		ELSE NULL
		END,
		SHASHU = CASE
		WHEN TSUKIN_SHUDAN_KBN IN
		('3','4') THEN #{shashu}
		ELSE NULL
		END,
		TOROKU_NO = CASE
		WHEN
		TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{torokuNo}
		ELSE NULL
		END,
		HAIKIRYO =
		CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{haikiryo}
		ELSE NULL
		END,
		SHAKEN_YUKO_KIGEN = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN
		#{shakenYukoKigen}
		ELSE NULL
		END,


		NENPI = NULL,

		HOKEN_MANNYO_YMD = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{hokenMannyoYmd}
		ELSE NULL
		END,
		TAIJIN_BAISYO = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN
		#{taijinBaisho}
		ELSE NULL
		END,
		TAIBUTSU_BAISYO = CASE
		WHEN
		TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{taibutsuBaisho}
		ELSE NULL
		END,
		JINSHIN_SHOGAI = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN
		#{jinshinShogai}
		ELSE NULL
		END,
		TOJOSHA_SHOGAI = CASE
		WHEN
		TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{tojoshaShogai}
		ELSE NULL
		END,
		TOKYU = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{tokyu}
		ELSE NULL
		END,
		FIRST_TEIKI_KIKAN = CASE
		WHEN TSUKIN_SHUDAN_KBN IN ('3','4') THEN
		#{firstTeikiKikan}
		ELSE NULL
		END,
		NEXT_TEIKI_KIKAN = CASE
		WHEN
		TSUKIN_SHUDAN_KBN IN ('3','4') THEN #{nextTeikiKikan}
		ELSE NULL
		END,
		UPD_USER_ID = #{updUserId},
		UPD_DATE = SYSDATE
		WHERE
		KIGYO_CD =
		#{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
		AND KEIRO_SEQ = #{keiroSeq}
	</update>



	<select id="selectShinseiDetail"
		resultType="org.cosmo.domain.ShinseiDetailVO">
		SELECT
		a.KIGYO_CD AS kigyoCd,
		a.SHINSEI_NO AS shinseiNo,

		a.SHINCHOKU_KBN AS shinchokuKbn,
		e.CODE_NM AS joutaiName,
		a.SHINSEI_YMD
		AS shinseiYmd,
		a.SASHIMODOSHI_YMD AS sashimodoshiYmd,

		TO_DATE(a.FIRST_SHINSEI_YMD, 'YYYYMMDD') AS saishinseiDate,
		TO_DATE(a.KIGYO_SHONIN_YMD, 'YYYYMMDD') AS shoninDate,
		TO_DATE(a.RIYO_START_YMD, 'YYYYMMDD') AS shikyuuKaishiDate,

		a.MOSHIOKURI_COMMENT AS honninComment,

		a.SHINSEI_KBN AS shinseiKbn,
		d.CODE_NM AS shinseiKbnName,
		a.SHINSEI_RIYU AS shinseiRiyu,

		(a.GEN_ADDRESS_1 || a.GEN_ADDRESS_2 || a.GEN_ADDRESS_3) AS genAddress,
		(a.NEW_ADDRESS_1 || a.NEW_ADDRESS_2 || a.NEW_ADDRESS_3) AS newAddress,

		a.GEN_SHOZOKU_CD AS shozokuBeforeNm,
		a.NEW_SHOZOKU_CD AS
		shozokuAfterNm,

		(a.GEN_KINMU_ADDRESS_1 || a.GEN_KINMU_ADDRESS_2 ||
		a.GEN_KINMU_ADDRESS_3) AS kinmuchiBefore,
		(a.NEW_KINMU_ADDRESS_1 ||
		a.NEW_KINMU_ADDRESS_2 ||
		a.NEW_KINMU_ADDRESS_3) AS kinmuchiAfter,

		TO_DATE(a.IDO_YMD, 'YYYYMMDD') AS idouDate,
		TO_DATE(a.TENNYU_YMD,
		'YYYYMMDD') AS tennyuDate,
		TO_DATE(a.RIYO_START_YMD,'YYYYMMDD') AS
		kaishiDate,

		b.KEIRO_SEQ AS keiroSeq,
		b.TSUKIN_SHUDAN_KBN AS
		tsukinShudanKbn,
		f.CODE_NM AS tsukinShudanName,

		(b.START_PLACE || ' -> '
		|| b.END_PLACE) AS keiro,
		b.START_PLACE AS startPlace,
		b.END_PLACE AS
		endPlace,

		b.SHINSEI_KM AS kyori,
		b.TSUKI_SHIKYU_KIN AS kingakuMonth,
		b.YURYO_DAI_ATO AS yuryodouroMonth,
		b.KATAMICHI_KIN AS katamichi,

		b.YURYO_KATAMICHI_KIN AS yuryoKatamichiKin,

		b.SANSHO_TEIKI_TSUKI_SU_1
		AS sanshoTeikiTsukiSu1,
		b.SANSHO_TEIKI_KIN_1 AS sanshoTeikiKin1,
		b.SANSHO_TEIKI_TSUKI_SU_2 AS sanshoTeikiTsukiSu2,
		b.SANSHO_TEIKI_KIN_2
		AS sanshoTeikiKin2,
		b.SANSHO_TEIKI_TSUKI_SU_3 AS sanshoTeikiTsukiSu3,
		b.SANSHO_TEIKI_KIN_3 AS sanshoTeikiKin3,

		b.YURYO_IC_S AS yuryoIcS,
		b.YURYO_IC_E AS yuryoIcE,

		NVL(c.NENPI, b.NENPI) AS nenpi,


		c.FILE_UID_1
		AS fileUid1,

		TO_DATE(c.MENKYO_YUKO_KIGEN, 'YYYYMMDD') AS
		menkyoYukoKigen,
		c.MENKYO_NO AS menkyoNo,
		c.SHASHU AS shashu,
		c.TOROKU_NO AS torokuNo,
		c.HAIKIRYO AS haikiryo,
		TO_DATE(c.SHAKEN_YUKO_KIGEN, 'YYYYMMDD') AS shakenYukoKigen,

		TO_DATE(c.HOKEN_MANRYO_YMD, 'YYYYMMDD') AS hokenManryoDate,
		c.TAIJIN_BAISHO AS taijinBaisho,
		c.TAIBUTSU_BAISHO AS taibutsuBaisho,
		c.JINSHIN_SHOGAI AS jinshinShogai,
		c.TOJOSHA_SHOGAI AS tojoshaShogai,
		c.TOKYU AS tokyu,
		c.FIRST_TEIKI_KIKAN AS firstTeikiKikan,
		c.NEXT_TEIKI_KIKAN AS nextTeikiKikan

		FROM
		SHINSEI a
		LEFT JOIN
		SHINSEI_START_KEIRO b
		ON a.KIGYO_CD = b.KIGYO_CD
		AND a.SHINSEI_NO =
		b.SHINSEI_NO
		LEFT JOIN SHINSEI_FUZUI_SHORUI c
		ON a.KIGYO_CD = c.KIGYO_CD
		AND a.SHINSEI_NO = c.SHINSEI_NO
		AND b.KEIRO_SEQ = c.KEIRO_SEQ
		LEFT JOIN
		CODE d
		ON d.CODE_SYBTSU = '101'
		AND d.CODE = a.SHINSEI_KBN
		LEFT JOIN CODE
		e
		ON e.CODE_SYBTSU = '102'
		AND e.CODE = a.SHINCHOKU_KBN
		LEFT JOIN CODE f
		ON f.CODE_SYBTSU = '103'
		AND f.CODE = b.TSUKIN_SHUDAN_KBN

		WHERE
		a.KIGYO_CD = #{kigyoCd}
		AND a.SHINSEI_NO = #{shinseiNo}
	</select>


	<select id="getNextShinseiNo" parameterType="map"
		resultType="string">
		SELECT
		LPAD(TO_CHAR(#{kigyoCd}), 3, '0')
		|| #{todayYmd}
		||
		LPAD(
		NVL(
		MAX( TO_NUMBER(SUBSTR(SHINSEI_NO, 12, 4)) ),
		0
		) + 1,
		4,
		'0'
		) AS
		nextShinseiNo
		FROM SHINSEI
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_YMD =
		#{todayYmd}
	</select>



	<insert id="insertHikimodoshiLog">
		INSERT INTO SHINSEI_LOG (
		KIGYO_CD
		, SHINSEI_NO
		,
		LOG_SEQ
		, SYORI_KBN
		, SHINSEI_KBN
		, SHINSEI_YMD
		, SHINSEI_RIYU
		,
		TOKU_SHINSEI_RIYU
		, SHAIN_UID
		, SHAIN_NO
		, DAIRI_SHINSEISHA_CD
		)
		SELECT
		a.KIGYO_CD
		, a.SHINSEI_NO
		, (
		SELECT NVL(MAX(l.LOG_SEQ), 0) + 1
		FROM
		SHINSEI_LOG l
		WHERE l.KIGYO_CD = a.KIGYO_CD
		AND l.SHINSEI_NO =
		a.SHINSEI_NO
		) AS LOG_SEQ
		, '6' AS SYORI_KBN
		, a.SHINSEI_KBN
		,
		a.SHINSEI_YMD
		, a.SHINSEI_RIYU
		, a.TOKU_SHINSEI_RIYU
		,
		a.SHAIN_UID
		,
		a.SHAIN_NO
		, a.DAIRI_SHINSEISHA_CD
		FROM SHINSEI a
		WHERE
		a.KIGYO_CD =
		#{kigyoCd}
		AND a.SHINSEI_NO = #{shinseiNo}
	</insert>


	<insert id="insertHikimodoshiProcessLog" parameterType="map">
		INSERT
		INTO PROCESS_LOG (
		PROCESS_TIMESTAMP,
		SUBSYSTEM_ID,
		PROCESS_COL,
		KEY1,
		KEY2,
		KEY3,
		KEY4,
		KEY5,
		DATA,
		USER_UID,
		USER_TRACK
		)
		VALUES (
		SYSTIMESTAMP,
		#{subsystemId, jdbcType=VARCHAR},
		'HIKIMODOSHI',
		#{shinseiNo,
		jdbcType=NUMERIC},
		#{shinseiKbn, jdbcType=VARCHAR},
		#{beforeShinchokuKbn, jdbcType=VARCHAR},
		#{afterShinchokuKbn,
		jdbcType=VARCHAR},
		#{kigyoCd, jdbcType=NUMERIC},
		NULL,
		#{loginUserId,
		jdbcType=NUMERIC},
		#{userIp, jdbcType=VARCHAR}
		)
	</insert>



	<update id="updateAlertForHikimodoshi">
		UPDATE ALERT
		SET SHINSEI_YMD = NULL,
		UPD_USER_ID =
		#{updUserId, jdbcType=NUMERIC},
		UPD_DATE = SYSTIMESTAMP
		WHERE KIGYO_CD =
		#{kigyoCd}
		AND SHAIN_NO = #{shainNo}
		AND SHINSEI_NO = #{shinseiNo}
	</update>



	<select id="getShinseiStatusForLog" resultType="map">
		SELECT
		SHINCHOKU_KBN AS shinchokuKbn,
		SHINSEI_KBN AS shinseiKbn
		FROM SHINSEI
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</select>


	<select id="getKakuninJyohou" parameterType="java.util.Map"
		resultType="org.cosmo.domain.ShinseiDetailVO">
		SELECT
		a.kigyo_cd AS kigyoCd,
		a.shinsei_no AS shinseiNo,
		a.shinsei_ymd AS
		shinseiYmd,
		a.sashimodoshi_ymd AS ssmdsYmd,
		a.shinsei_kigen_ymd AS
		shinseiKigenYmd,
		a.shinchoku_kbn AS shinchokuKbn,
		a.moshiokuri_comment
		AS moComment,
		a.torikeshi_ymd AS torikeshiYmd,


		(a.gen_address_1 || ' ' || a.gen_address_2 || ' ' || a.gen_address_3)
		AS genAddress,
		(a.new_address_1 || ' ' || a.new_address_2 || ' ' ||
		a.new_address_3) AS newAddress,


		a.gen_address_1 AS genAddress1,
		a.gen_address_2 AS genAddress2,
		a.gen_address_3 AS genAddress3,
		a.new_zip_cd AS newZipCd,
		a.new_address_1 AS newAddress1,
		a.new_address_2 AS newAddress2,
		a.new_address_3 AS newAddress3,

		a.gen_shozoku_cd AS genShozoku,
		a.new_shozoku_cd AS newShozoku,


		(a.gen_kinmu_address_1 || ' ' || a.gen_kinmu_address_2) AS
		genKinmuchi,
		(a.new_kinmu_address_1 || ' ' || a.new_kinmu_address_2) AS
		newKinmuchi,


		a.gen_kinmu_address_1 AS genKinmuAddress1,
		a.gen_kinmu_address_2 AS
		genKinmuAddress2,
		a.new_kinmu_zip_cd AS
		newKinmuZipCd,
		a.new_kinmu_address_1 AS
		newKinmuAddress1,
		a.new_kinmu_address_2 AS
		newKinmuAddress2,
		a.new_kinmu_address_3 AS
		newKinmuAddress3,


		a.shinsei_kbn AS shinseiKbn,
		a.shinsei_riyu AS
		shinseiRiyu,
		a.ido_ymd AS
		idoYmd,
		a.iten_ymd AS
		itenYmd,
		a.tennyu_ymd AS
		tennyuYmd,
		a.keiro_henko_ymd AS keiroHenkoYmd,
		a.riyo_start_ymd AS
		riyoStartYmd,


		a.address_ido_keido AS
		addressIdoKeido,
		a.address_chg_kbn
		AS
		addressChgKbn,
		a.kinmu_address_ido_keido AS kinmuAddressIdoKeido,
		a.kinmu_address_chg_kbn AS kinmuAddressChgKbn,


		a.etc_file_uid_1 AS
		etcFileUid1,
		a.etc_file_uid_2 AS etcFileUid2,
		a.etc_file_uid_3 AS
		etcFileUid3,
		a.etc_file_uid_4 AS etcFileUid4,
		a.etc_file_uid_5 AS
		etcFileUid5,
		a.etc_comment_1 AS etcComment1,
		a.etc_comment_2 AS
		etcComment2,
		a.etc_comment_3 AS etcComment3,
		a.etc_comment_4 AS
		etcComment4,
		a.etc_comment_5 AS etcComment5,


		b.keiro_seq AS keiroSeq,
		b.tsukin_shudan_kbn AS tsukinShudanKbn,
		d.code_nm AS shudanName,
		b.start_place AS startPlace,
		b.end_place AS
		endPlace,
		b.shinsei_km AS
		shinseiKm,
		b.yuryo_ic_s AS yuryoIcS,
		b.yuryo_ic_e AS yuryoIcE,
		b.yuryo_katamichi_kin AS yuryoKatamichiKin,
		b.jitsu_kinmu_nissu AS
		jitsuKinmuNissu,
		b.sansho_teiki_tsuki_su_1 AS
		sanshoTeikiTsukiSu1,
		b.sansho_teiki_kin_1 AS sanshoTeikiKin1,
		b.sansho_teiki_tsuki_su_2 AS
		sanshoTeikiTsukiSu2,
		b.sansho_teiki_kin_2
		AS sanshoTeikiKin2,
		b.sansho_teiki_tsuki_su_3 AS sanshoTeikiTsukiSu3,
		b.sansho_teiki_kin_3
		AS sanshoTeikiKin3,
		b.katamichi_kin AS katamichi,
		b.tsuki_shikyu_kin AS
		tsuki,


		c.file_uid_1 AS etcFileUid1,
		c.file_uid_2 AS etcFileUid2,
		c.file_uid_3
		AS etcFileUid3,
		c.file_uid_4 AS etcFileUid4,
		c.file_uid_5 AS
		etcFileUid5,
		TO_DATE(c.menkyo_yuko_kigen, 'YYYYMMDD') AS
		menkyoYukoKigen,
		c.menkyo_no AS menkyoNo,
		c.shashu AS shashu,
		c.toroku_no AS torokuNo,
		c.haikiryo AS haikiryo,
		TO_DATE(c.shaken_yuko_kigen, 'YYYYMMDD') AS shakenYukoKigen,
		c.nenpi AS
		nenpi,
		TO_DATE(c.hoken_manryo_ymd, 'YYYYMMDD') AS hokenManryoDate,
		c.taijin_baisho AS taijinBaisho,
		c.taibutsu_baisho AS taibutsuBaisho,
		c.jinshin_shogai AS jinshinShogai,
		c.tojosha_shogai AS tojoshaShogai,
		c.tokyu AS tokyu,
		c.first_teiki_kikan AS firstTeikiKikan,
		c.next_teiki_kikan AS nextTeikiKikan
		FROM
		shinsei a
		INNER JOIN
		shinsei_start_keiro b
		ON a.kigyo_cd = b.kigyo_cd
		AND a.shinsei_no =
		b.shinsei_no
		LEFT JOIN
		shinsei_fuzui_shorui c
		ON b.kigyo_cd = c.kigyo_cd
		AND b.shinsei_no = c.shinsei_no
		AND b.keiro_seq = c.keiro_seq
		LEFT JOIN
		code d
		ON d.code_sybtsu = '103'
		AND b.tsukin_shudan_kbn = d.code
		WHERE
		a.kigyo_cd = #{kigyoCd}
		AND a.shinsei_no = #{shinseiNo}
		ORDER BY
		b.keiro_seq
	</select>

	<select id="getShinseiShorui" parameterType="Long"
		resultType="org.cosmo.domain.ShinseiShoruiVO">
		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		SHINSEI_KBN AS shinseiKbn,
		SHINSEI_YMD AS
		shinseiYmd,
		SHAIN_UID AS shainUid,
		SHAIN_NO AS shainNo,
		DAIRI_SHINSEISHA_CD AS dairiShinseishaCd,
		TSUKIN_SHUDAN_KBN AS
		tsukinShudanKbn,
		MENKYO_YUKO_KIGEN AS menkyoYukoKigen,
		MENKYO_NO AS
		menkyoNo,
		SHASHU AS
		shashu,
		TOROKU_NO AS torokuNo,
		HAIKIRYO AS haikiryo,
		SHAKEN_YUKO_KIGEN AS
		shakenYukoKigen,
		NENPI AS nenpi,

		HOKEN_MANRYO_YMD AS
		hokenManryoYmd,
		TAIJIN_BAISHO AS taijinBaisho,
		TAIBUTSU_BAISHO AS
		taibutsuBaisho,
		JINSHIN_SHOGAI AS jinshinShogai,
		TOJOSHA_SHOGAI AS
		tojoshaShogai,
		TOKYU
		AS tokyu,

		FIRST_TEIKI_KIKAN AS firstTeikiKikan,
		NEXT_TEIKI_KIKAN AS
		nextTeikiKikan,
		ADD_USER_ID AS addUserId,
		ADD_DATE AS
		addDate,
		UPD_USER_ID AS updUserId,
		UPD_DATE AS updDate,
		FILE_UID_1 AS
		fileUid1,
		FILE_UID_2 AS fileUid2,
		FILE_UID_3 AS fileUid3,
		FILE_UID_4 AS
		fileUid4,
		FILE_UID_5 AS fileUid5
		FROM
		SHINSEI_FUZUI_SHORUI
		WHERE
		SHINSEI_NO = #{shinseiNo}
		AND KEIRO_SEQ = 1
	</select>





	<insert id="insertOshiraseHikimodosu" parameterType="map">
		INSERT INTO
		OSHIRASE (
		KIGYO_CD,
		SHAIN_UID,
		SHAIN_NO,
		TSUCHI_YMD,
		TSUCHI_HM,
		TSUCHISHA_KIGYO_CD,
		TSUCHISHA_CD,
		SHINSEI_NO,
		OSHIRASE_NAIYO,
		KENGEN,
		ADD_USER_ID,
		ADD_DATE,
		UPD_USER_ID,
		UPD_DATE
		) VALUES (
		#{loginUser.kigyo_Cd},
		#{shinseiUser.shain_Uid},
		#{shinseiUser.shain_No},
		TO_CHAR(SYSDATE,'YYYYMMDD'),
		TO_CHAR(SYSDATE,'HH24MI'),
		#{loginUser.kigyo_Cd},
		#{loginUser.shain_No},
		#{shinseiNo},
		'引き戻し',
		NULL,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP
		)
	</insert>


	<insert id="insertOshiraseReapply" parameterType="map">
		INSERT INTO
		OSHIRASE (
		KIGYO_CD,
		SHAIN_UID,
		SHAIN_NO,
		TSUCHI_YMD,
		TSUCHI_HM,
		TSUCHISHA_KIGYO_CD,
		TSUCHISHA_CD,
		SHINSEI_NO,
		OSHIRASE_NAIYO,
		KENGEN,
		ADD_USER_ID,
		ADD_DATE,
		UPD_USER_ID,
		UPD_DATE
		) VALUES (
		#{shinseiUser.kigyo_Cd},
		#{shinseiUser.shain_Uid},
		#{shinseiUser.shain_No},
		TO_CHAR(SYSDATE,'YYYYMMDD'),
		TO_CHAR(SYSDATE,'HH24MI'),
		#{loginUser.kigyo_Cd},
		#{loginUser.shain_No},
		#{shinseiNo},
		'再申請',
		NULL,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP,
		#{loginUser.shain_Uid},
		SYSTIMESTAMP
		)
	</insert>

	<select id="getShinseiKeiroDetailList" parameterType="map"
		resultType="org.cosmo.domain.ShinseiKeiroDetailVO">

		SELECT
		KIGYO_CD AS kigyoCd,
		SHINSEI_NO AS shinseiNo,
		KEIRO_SEQ AS keiroSeq,
		TSUKIN_SHUDAN_KBN AS tsukinShudanKbn,
		START_PLACE AS startPlace,
		END_PLACE AS endPlace,
		SHINSEI_KM AS
		shinseiKm,
		KATAMICHI_KIN AS katamichi,
		TSUKI_SHIKYU_KIN AS tsuki,
		SANSHO_TEIKI_KIN_1 AS sanshoTeikiKin1,
		SANSHO_TEIKI_TSUKI_SU_1 AS
		sanshoTeikiTsukiSu1,
		SANSHO_TEIKI_KIN_2 AS sanshoTeikiKin2,
		SANSHO_TEIKI_TSUKI_SU_2 AS
		sanshoTeikiTsukiSu2,
		SANSHO_TEIKI_KIN_3 AS
		sanshoTeikiKin3,
		SANSHO_TEIKI_TSUKI_SU_3 AS sanshoTeikiTsukiSu3,
		YURYO_IC_S AS yuryoIcS,
		YURYO_IC_E AS yuryoIcE,
		FIRST_TEIKI_TSUKI_SU AS
		firstTeikiKikan,
		NEXT_TEIKI_TSUKI_SU AS nextTeikiKikan
		FROM
		SHINSEI_START_KEIRO
		WHERE KIGYO_CD =
		#{kigyoCd}
		AND SHINSEI_NO =
		#{shinseiNo}
		ORDER BY
		KEIRO_SEQ
	</select>


	<select id="getNextShinseiLogSeq" resultType="long">
		SELECT
		NVL(MAX(LOG_SEQ), 0) + 1
		FROM SHINSEI_LOG
		WHERE KIGYO_CD = #{kigyoCd}
		AND SHINSEI_NO = #{shinseiNo}
	</select>


	<insert id="insertReapplyLog">
		INSERT INTO SHINSEI_LOG (
		KIGYO_CD,
		SHINSEI_NO,
		LOG_SEQ,
		SYORI_KBN,
		SHINSEI_KBN,
		SHINSEI_YMD,
		SHINSEI_RIYU,
		TOKU_SHINSEI_RIYU,
		SHAIN_UID,
		SHAIN_NO,
		DAIRI_SHINSEISHA_CD
		)
		SELECT
		KIGYO_CD,
		SHINSEI_NO,
		#{logSeq},
		#{syoriKbn},
		SHINSEI_KBN,
		SHINSEI_YMD,
		SHINSEI_RIYU,
		TOKU_SHINSEI_RIYU,
		SHAIN_UID,
		SHAIN_NO,
		DAIRI_SHINSEISHA_CD
		FROM SHINSEI
		WHERE KIGYO_CD = #{kigyoCd}
		AND
		SHINSEI_NO = #{shinseiNo}
	</insert>


	<insert id="insertSaishinseiProcessLog">
		INSERT INTO PROCESS_LOG (
		PROCESS_TIMESTAMP,
		SUBSYSTEM_ID,
		PROCESS_COL,
		KEY1,
		KEY2,
		KEY3,
		KEY4,
		KEY5,
		DATA,
		USER_UID,
		USER_TRACK
		)
		VALUES (
		SYSTIMESTAMP,
		#{subsystemId, jdbcType=VARCHAR},
		#{process, jdbcType=VARCHAR},
		#{key1, jdbcType=VARCHAR},
		#{key2,
		jdbcType=VARCHAR},
		#{key3, jdbcType=VARCHAR},
		#{key4, jdbcType=VARCHAR},
		#{key5, jdbcType=VARCHAR},
		#{data, jdbcType=VARCHAR},
		#{userUid,
		jdbcType=VARCHAR},
		#{userTrack, jdbcType=VARCHAR}
		)
	</insert>





	<resultMap id="shinseiResultMap"
		type="org.cosmo.domain.ShinseiDTO">

		<id column="KIGYO_CD" property="kigyoCd" />
		<id column="SHINSEI_NO" property="shinseiNo" />

		<result column="SHINSEI_KBN" property="shinseiKbn" />
		<result column="SHINSEI_YMD" property="shinseiYmd" />
		<result column="SHINSEI_RIYU" property="shinseiRiyu" />
		<result column="TOKU_SHINSEI_RIYU" property="tokuShinseiRiyu" />
		<result column="SHAIN_UID" property="shainUid" />
		<result column="SHAIN_NO" property="shainNo" />
		<result column="DAIRI_SHINSEISHA_CD"
			property="dairiShinseishaCd" />
		<result column="SHINCHOKU_KBN" property="shinchokuKbn" />
		<result column="GEN_TSUKINRO_END_KBN"
			property="genTsukinroEndKbn" />

		<result column="ADDRESS_CHG_KBN" property="addressChgKbn" />
		<result column="KINMU_ADDRESS_CHG_KBN"
			property="kinmuAddressChgKbn" />
		<result column="KYUSHOKU_HUKKI_KBN" property="kyushokuHukkiKbn" />

		<result column="GEN_SHOZOKU_CD" property="genShozokuCd" />
		<result column="GEN_ZIP_CD" property="genZipCd" />
		<result column="GEN_ADDRESS_1" property="genAddress1" />
		<result column="GEN_ADDRESS_2" property="genAddress2" />
		<result column="GEN_ADDRESS_3" property="genAddress3" />

		<result column="NEW_SHOZOKU_CD" property="newShozokuCd" />
		<result column="NEW_ZIP_CD" property="newZipCd" />
		<result column="NEW_ADDRESS_1" property="newAddress1" />
		<result column="NEW_ADDRESS_2" property="newAddress2" />
		<result column="NEW_ADDRESS_3" property="newAddress3" />
		<result column="ADDRESS_IDO_KEIDO" property="addressIdoKeido" />
		<result column="ADDRESS_CORRECT" property="addressCorrect" />

		<result column="GEN_KINMU_ZIP_CD" property="genKinmuZipCd" />
		<result column="GEN_KINMU_ADDRESS_1"
			property="genKinmuAddress1" />
		<result column="GEN_KINMU_ADDRESS_2"
			property="genKinmuAddress2" />
		<result column="GEN_KINMU_ADDRESS_3"
			property="genKinmuAddress3" />
		<result column="GEN_KINMU_PREF_CD" property="genKinmuPrefCd" />

		<result column="NEW_KINMU_ZIP_CD" property="newKinmuZipCd" />
		<result column="NEW_KINMU_ADDRESS_1"
			property="newKinmuAddress1" />
		<result column="NEW_KINMU_ADDRESS_2"
			property="newKinmuAddress2" />
		<result column="NEW_KINMU_ADDRESS_3"
			property="newKinmuAddress3" />
		<result column="KINMU_ADDRESS_IDO_KEIDO"
			property="kinmuAddressIdoKeido" />
		<result column="KINMU_ADDRESS_CORRECT"
			property="kinmuAddressCorrect" />
		<result column="NEW_KINMU_PREF_CD" property="newKinmuPrefCd" />
		<result column="JUTAKU_KBN" property="jutakuKbn" />

		<result column="ETC_FILE_UID_1" property="etcFileUid1" />
		<result column="ETC_FILE_UID_2" property="etcFileUid2" />
		<result column="ETC_FILE_UID_3" property="etcFileUid3" />
		<result column="ETC_FILE_UID_4" property="etcFileUid4" />
		<result column="ETC_FILE_UID_5" property="etcFileUid5" />
		<result column="ETC_COMMENT_1" property="etcComment1" />
		<result column="ETC_COMMENT_2" property="etcComment2" />
		<result column="ETC_COMMENT_3" property="etcComment3" />
		<result column="ETC_COMMENT_4" property="etcComment4" />
		<result column="ETC_COMMENT_5" property="etcComment5" />

		<result column="RIYO_START_YMD" property="riyoStartYmd" />
		<result column="RIYO_END_YMD" property="riyoEndYmd" />
		<result column="SHIKYU_TEISHI_KBN" property="shikyTeishiKbn" />
		<result column="KANRIID" property="kanriId" />
		<result column="IDO_YMD" property="idoYmd" />
		<result column="ITEN_YMD" property="itenYmd" />
		<result column="TENNYU_YMD" property="tennyuYmd" />
		<result column="HAISHIN_YMD" property="haishinYmd" />
		<result column="KEIRO_HENKO_YMD" property="keiroHenkoYmd" />
		<result column="FIRST_SHINSEI_YMD" property="firstShinseiYmd" />
		<result column="KIGYO_SHONIN_YMD" property="kigyoShoninYmd" />
		<result column="LL_SHONIN_YMD" property="llShoninYmd" />
		<result column="TSUKINRO_NO" property="tsukinroNo" />
		<result column="SASHIMODOSHI_YMD" property="sashimodoshiYmd" />
		<result column="SHINSEI_KIGEN_YMD" property="shinseiKigenYmd" />
		<result column="MOSHIOKURI_COMMENT"
			property="moshiokuriComment" />
		<result column="BIBO_COMMENT" property="biboComment" />
		<result column="ALERT_UMU" property="alertUmu" />
		<result column="TORIKESHI_YMD" property="torikeshiYmd" />
		<result column="TORIKESHI_RIYU" property="torikeshiRiyu" />
		<result column="ICHIJI_HOZON_ID" property="ichijiHozonId" />
		<result column="JITSU_KM" property="jitsuKm" />
		<result column="NAVITIME_VIEW_CNT" property="navitimeViewCnt" />

		<result column="ADD_USER_ID" property="addUserId" />
		<result column="ADD_DATE" property="addDate" />
		<result column="UPD_USER_ID" property="updUserId" />
		<result column="UPD_DATE" property="updDate" />

	</resultMap>







</mapper>